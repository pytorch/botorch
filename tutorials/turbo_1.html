<!DOCTYPE html><html lang=""><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>BoTorch · Bayesian Optimization in PyTorch</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="Bayesian Optimization in PyTorch"/><meta property="og:title" content="BoTorch · Bayesian Optimization in PyTorch"/><meta property="og:type" content="website"/><meta property="og:url" content="https://botorch.org/"/><meta property="og:description" content="Bayesian Optimization in PyTorch"/><meta property="og:image" content="https://botorch.org/img/botorch.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://botorch.org/img/botorch.png"/><link rel="shortcut icon" href="/img/botorch.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-139570076-2', 'auto');
              ga('send', 'pageview');
            </script><link rel="stylesheet" href="/css/code_block_buttons.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="/js/code_block_buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/mathjax.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/botorch_logo_lockup_white.png" alt="BoTorch"/><h2 class="headerTitleWithLogo">BoTorch</h2></a><a href="/versions"><h3>stable</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/docs/introduction" target="_self">Docs</a></li><li class=""><a href="/tutorials/" target="_self">Tutorials</a></li><li class=""><a href="/api/" target="_self">API Reference</a></li><li class=""><a href="/docs/papers" target="_self">Papers</a></li><li class=""><a href="https://github.com/pytorch/botorch" target="_self">GitHub</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span></span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Tutorials</h3><ul class=""><li class="navListItem"><a class="navItem" href="/tutorials/">Overview</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Using BoTorch with Ax</h3><ul class=""><li class="navListItem"><a class="navItem" href="/tutorials/custom_botorch_model_in_ax">Using a custom BoTorch model</a></li><li class="navListItem"><a class="navItem" href="/tutorials/custom_acquisition">Writing a custom acquisition function</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Full Optimization Loops</h3><ul class=""><li class="navListItem"><a class="navItem" href="/tutorials/closed_loop_botorch_only">q-Noisy Constrained EI</a></li><li class="navListItem"><a class="navItem" href="/tutorials/preference_bo">Bayesian optimization with pairwise comparison data</a></li><li class="navListItem"><a class="navItem" href="/tutorials/bope">Bayesian optimization with preference exploration (BOPE)</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/tutorials/turbo_1">Trust Region Bayesian Optimization (TuRBO)</a></li><li class="navListItem"><a class="navItem" href="/tutorials/scalable_constrained_bo">Scalable Constrained Bayesian Optimization (SCBO)</a></li><li class="navListItem"><a class="navItem" href="/tutorials/saasbo">High-dimensional Bayesian optimization with SAASBO</a></li><li class="navListItem"><a class="navItem" href="/tutorials/Multi_objective_multi_fidelity_BO">Multi-Objective-Multi-Fidelity optimization with MOMF</a></li><li class="navListItem"><a class="navItem" href="/tutorials/bo_with_warped_gp">Bayesian optimization with input warping</a></li><li class="navListItem"><a class="navItem" href="/tutorials/thompson_sampling">Bayesian optimization with large-scale Thompson sampling</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Multi-Objective Bayesian Optimization</h3><ul class=""><li class="navListItem"><a class="navItem" href="/tutorials/multi_objective_bo">Multi-objective optimization with qEHVI, qNEHVI, and qNParEGO</a></li><li class="navListItem"><a class="navItem" href="/tutorials/constrained_multi_objective_bo">Constrained multi-objective optimization with qNEHVI and qParEGO</a></li><li class="navListItem"><a class="navItem" href="/tutorials/robust_multi_objective_bo">Robust multi-objective Bayesian optimization under input noise</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Bite-Sized Tutorials</h3><ul class=""><li class="navListItem"><a class="navItem" href="/tutorials/fit_model_with_torch_optimizer">Fitting a model using torch.optim</a></li><li class="navListItem"><a class="navItem" href="/tutorials/compare_mc_analytic_acquisition">Comparing analytic and MC Expected Improvement</a></li><li class="navListItem"><a class="navItem" href="/tutorials/optimize_with_cmaes">Acquisition function optimization with CMA-ES</a></li><li class="navListItem"><a class="navItem" href="/tutorials/optimize_stochastic">Acquisition function optimization with torch.optim</a></li><li class="navListItem"><a class="navItem" href="/tutorials/batch_mode_cross_validation">Using batch evaluation for fast cross-validation</a></li><li class="navListItem"><a class="navItem" href="/tutorials/one_shot_kg">The one-shot Knowledge Gradient acquisition function</a></li><li class="navListItem"><a class="navItem" href="/tutorials/max_value_entropy">The max-value entropy search acquisition function</a></li><li class="navListItem"><a class="navItem" href="/tutorials/GIBBON_for_efficient_batch_entropy_search">The GIBBON acquisition function for efficient batch entropy search</a></li><li class="navListItem"><a class="navItem" href="/tutorials/risk_averse_bo_with_environmental_variables">Risk averse Bayesian optimization with environmental variables</a></li><li class="navListItem"><a class="navItem" href="/tutorials/risk_averse_bo_with_input_perturbations">Risk averse Bayesian optimization with input perturbations</a></li><li class="navListItem"><a class="navItem" href="/tutorials/constraint_active_search">Constraint Active Search for Multiobjective Experimental Design</a></li><li class="navListItem"><a class="navItem" href="/tutorials/information_theoretic_acquisition_functions">Information-theoretic acquisition functions</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Advanced Usage</h3><ul class=""><li class="navListItem"><a class="navItem" href="/tutorials/meta_learning_with_rgpe">Meta-learning with RGPE</a></li><li class="navListItem"><a class="navItem" href="/tutorials/vae_mnist">High-dimensional optimization with VAEs</a></li><li class="navListItem"><a class="navItem" href="/tutorials/multi_fidelity_bo">Multi-fidelity Bayesian optimization using KG</a></li><li class="navListItem"><a class="navItem" href="/tutorials/discrete_multi_fidelity_bo">Multi-fidelity Bayesian optimization with discrete fidelities using KG</a></li><li class="navListItem"><a class="navItem" href="/tutorials/composite_bo_with_hogp">Composite Bayesian optimization with the High Order Gaussian Process</a></li><li class="navListItem"><a class="navItem" href="/tutorials/composite_mtbo">Composite Bayesian Optimization with Multi-Task Gaussian Processes</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="tutorialBody">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<div class="notebook">
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="BO-with-TuRBO-1-and-TS/qEI">BO with TuRBO-1 and TS/qEI<a class="anchor-link" href="#BO-with-TuRBO-1-and-TS/qEI">¶</a></h2><p>In this tutorial, we show how to implement Trust Region Bayesian Optimization (TuRBO) [1] in a closed loop in BoTorch.</p>
<p>This implementation uses one trust region (TuRBO-1) and supports either parallel expected improvement (qEI) or Thompson sampling (TS). We optimize the $20D$ Ackley function on the domain $[-5, 10]^{20}$ and show that TuRBO-1 outperforms qEI as well as Sobol.</p>
<p>Since botorch assumes a maximization problem, we will attempt to maximize $-f(x)$ to achieve $\max_x -f(x)=0$.</p>
<p>[1]: <a href="https://proceedings.neurips.cc/paper/2019/file/6c990b7aca7bc7058f5e98ea909e924b-Paper.pdf">Eriksson, David, et al. Scalable global optimization via local Bayesian optimization. Advances in Neural Information Processing Systems. 2019</a></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>

<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">botorch.acquisition</span> <span class="kn">import</span> <span class="n">qExpectedImprovement</span>
<span class="kn">from</span> <span class="nn">botorch.fit</span> <span class="kn">import</span> <span class="n">fit_gpytorch_mll</span>
<span class="kn">from</span> <span class="nn">botorch.generation</span> <span class="kn">import</span> <span class="n">MaxPosteriorSampling</span>
<span class="kn">from</span> <span class="nn">botorch.models</span> <span class="kn">import</span> <span class="n">SingleTaskGP</span>
<span class="kn">from</span> <span class="nn">botorch.optim</span> <span class="kn">import</span> <span class="n">optimize_acqf</span>
<span class="kn">from</span> <span class="nn">botorch.test_functions</span> <span class="kn">import</span> <span class="n">Ackley</span>
<span class="kn">from</span> <span class="nn">botorch.utils.transforms</span> <span class="kn">import</span> <span class="n">unnormalize</span>
<span class="kn">from</span> <span class="nn">torch.quasirandom</span> <span class="kn">import</span> <span class="n">SobolEngine</span>

<span class="kn">import</span> <span class="nn">gpytorch</span>
<span class="kn">from</span> <span class="nn">gpytorch.constraints</span> <span class="kn">import</span> <span class="n">Interval</span>
<span class="kn">from</span> <span class="nn">gpytorch.kernels</span> <span class="kn">import</span> <span class="n">MaternKernel</span><span class="p">,</span> <span class="n">ScaleKernel</span>
<span class="kn">from</span> <span class="nn">gpytorch.likelihoods</span> <span class="kn">import</span> <span class="n">GaussianLikelihood</span>
<span class="kn">from</span> <span class="nn">gpytorch.mlls</span> <span class="kn">import</span> <span class="n">ExactMarginalLogLikelihood</span>
<span class="kn">from</span> <span class="nn">gpytorch.priors</span> <span class="kn">import</span> <span class="n">HorseshoePrior</span>


<span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">"cuda"</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">"cpu"</span><span class="p">)</span>
<span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">double</span>
<span class="n">SMOKE_TEST</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"SMOKE_TEST"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Optimize-the-20-dimensional-Ackley-function">Optimize the 20-dimensional Ackley function<a class="anchor-link" href="#Optimize-the-20-dimensional-Ackley-function">¶</a></h2><p>The goal is to minimize the popular Ackley function:</p>
<p>$f(x_1,\ldots,x_d) = -20\exp\left(-0.2 \sqrt{\frac{1}{d} \sum_{j=1}^d x_j^2} \right) -\exp \left( \frac{1}{d} \sum_{j=1}^d \cos(2 \pi x_j) \right) + 20 + e$</p>
<p>over the domain  $[-5, 10]^{20}$.  The global optimal value of $0$ is attained at $x_1 = \ldots = x_d = 0$.</p>
<p>As mentioned above, since botorch assumes a maximization problem, we instead maximize $-f(x)$.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">fun</span> <span class="o">=</span> <span class="n">Ackley</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">negate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<span class="n">fun</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">fill_</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="n">fun</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">fill_</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">dim</span> <span class="o">=</span> <span class="n">fun</span><span class="o">.</span><span class="n">dim</span>
<span class="n">lb</span><span class="p">,</span> <span class="n">ub</span> <span class="o">=</span> <span class="n">fun</span><span class="o">.</span><span class="n">bounds</span>

<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">n_init</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">dim</span>
<span class="n">max_cholesky_size</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">"inf"</span><span class="p">)</span>  <span class="c1"># Always use Cholesky</span>


<span class="k">def</span> <span class="nf">eval_objective</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">"""This is a helper function we use to unnormalize and evalaute a point"""</span>
    <span class="k">return</span> <span class="n">fun</span><span class="p">(</span><span class="n">unnormalize</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fun</span><span class="o">.</span><span class="n">bounds</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Maintain-the-TuRBO-state">Maintain the TuRBO state<a class="anchor-link" href="#Maintain-the-TuRBO-state">¶</a></h2><p>TuRBO needs to maintain a state, which includes the length of the trust region, success and failure counters, success and failure tolerance, etc.</p>
<p>In this tutorial we store the state in a dataclass and update the state of TuRBO after each batch evaluation.</p>
<p><strong>Note</strong>: These settings assume that the domain has been scaled to $[0, 1]^d$ and that the same batch size is used for each iteration.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">TurboState</span><span class="p">:</span>
    <span class="n">dim</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">length</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.8</span>
    <span class="n">length_min</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">**</span> <span class="mi">7</span>
    <span class="n">length_max</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.6</span>
    <span class="n">failure_counter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">failure_tolerance</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">"nan"</span><span class="p">)</span>  <span class="c1"># Note: Post-initialized</span>
    <span class="n">success_counter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">success_tolerance</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># Note: The original paper uses 3</span>
    <span class="n">best_value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s2">"inf"</span><span class="p">)</span>
    <span class="n">restart_triggered</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">failure_tolerance</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span>
            <span class="nb">max</span><span class="p">([</span><span class="mf">4.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">])</span>
        <span class="p">)</span>


<span class="k">def</span> <span class="nf">update_state</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">Y_next</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">Y_next</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">state</span><span class="o">.</span><span class="n">best_value</span> <span class="o">+</span> <span class="mf">1e-3</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">best_value</span><span class="p">):</span>
        <span class="n">state</span><span class="o">.</span><span class="n">success_counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">state</span><span class="o">.</span><span class="n">failure_counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">state</span><span class="o">.</span><span class="n">success_counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">state</span><span class="o">.</span><span class="n">failure_counter</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">success_counter</span> <span class="o">==</span> <span class="n">state</span><span class="o">.</span><span class="n">success_tolerance</span><span class="p">:</span>  <span class="c1"># Expand trust region</span>
        <span class="n">state</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">state</span><span class="o">.</span><span class="n">length</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">length_max</span><span class="p">)</span>
        <span class="n">state</span><span class="o">.</span><span class="n">success_counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">state</span><span class="o">.</span><span class="n">failure_counter</span> <span class="o">==</span> <span class="n">state</span><span class="o">.</span><span class="n">failure_tolerance</span><span class="p">:</span>  <span class="c1"># Shrink trust region</span>
        <span class="n">state</span><span class="o">.</span><span class="n">length</span> <span class="o">/=</span> <span class="mf">2.0</span>
        <span class="n">state</span><span class="o">.</span><span class="n">failure_counter</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">state</span><span class="o">.</span><span class="n">best_value</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">best_value</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">Y_next</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">length</span> <span class="o">&lt;</span> <span class="n">state</span><span class="o">.</span><span class="n">length_min</span><span class="p">:</span>
        <span class="n">state</span><span class="o">.</span><span class="n">restart_triggered</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="n">state</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Take-a-look-at-the-state">Take a look at the state<a class="anchor-link" href="#Take-a-look-at-the-state">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">state</span> <span class="o">=</span> <span class="n">TurboState</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>TurboState(dim=20, batch_size=4, length=0.8, length_min=0.0078125, length_max=1.6, failure_counter=0, failure_tolerance=5, success_counter=0, success_tolerance=10, best_value=-inf, restart_triggered=False)
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Generate-initial-points">Generate initial points<a class="anchor-link" href="#Generate-initial-points">¶</a></h2><p>This generates an initial set of Sobol points that we use to start of the BO loop.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_initial_points</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">n_pts</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">sobol</span> <span class="o">=</span> <span class="n">SobolEngine</span><span class="p">(</span><span class="n">dimension</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span> <span class="n">scramble</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">X_init</span> <span class="o">=</span> <span class="n">sobol</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n_pts</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">X_init</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Generate-new-batch">Generate new batch<a class="anchor-link" href="#Generate-new-batch">¶</a></h2><p>Given the current <code>state</code> and a probabilistic (GP) <code>model</code> built from observations <code>X</code> and <code>Y</code>, we generate a new batch of points.</p>
<p>This method works on the domain $[0, 1]^d$, so make sure to not pass in observations from the true domain.  <code>unnormalize</code> is called before the true function is evaluated which will first map the points back to the original domain.</p>
<p>We support either TS and qEI which can be specified via the <code>acqf</code> argument.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">generate_batch</span><span class="p">(</span>
    <span class="n">state</span><span class="p">,</span>
    <span class="n">model</span><span class="p">,</span>  <span class="c1"># GP model</span>
    <span class="n">X</span><span class="p">,</span>  <span class="c1"># Evaluated points on the domain [0, 1]^d</span>
    <span class="n">Y</span><span class="p">,</span>  <span class="c1"># Function values</span>
    <span class="n">batch_size</span><span class="p">,</span>
    <span class="n">n_candidates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># Number of candidates for Thompson sampling</span>
    <span class="n">num_restarts</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">raw_samples</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span>
    <span class="n">acqf</span><span class="o">=</span><span class="s2">"ts"</span><span class="p">,</span>  <span class="c1"># "ei" or "ts"</span>
<span class="p">):</span>
    <span class="k">assert</span> <span class="n">acqf</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">"ts"</span><span class="p">,</span> <span class="s2">"ei"</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">X</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mf">0.0</span> <span class="ow">and</span> <span class="n">X</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mf">1.0</span> <span class="ow">and</span> <span class="n">torch</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">n_candidates</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">n_candidates</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">200</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

    <span class="c1"># Scale the TR to be proportional to the lengthscales</span>
    <span class="n">x_center</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">.</span><span class="n">argmax</span><span class="p">(),</span> <span class="p">:]</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">covar_module</span><span class="o">.</span><span class="n">base_kernel</span><span class="o">.</span><span class="n">lengthscale</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">weights</span> <span class="o">/</span> <span class="n">weights</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">weights</span> <span class="o">/</span> <span class="n">torch</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">weights</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">weights</span><span class="p">)))</span>
    <span class="n">tr_lb</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">clamp</span><span class="p">(</span><span class="n">x_center</span> <span class="o">-</span> <span class="n">weights</span> <span class="o">*</span> <span class="n">state</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">tr_ub</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">clamp</span><span class="p">(</span><span class="n">x_center</span> <span class="o">+</span> <span class="n">weights</span> <span class="o">*</span> <span class="n">state</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">acqf</span> <span class="o">==</span> <span class="s2">"ts"</span><span class="p">:</span>
        <span class="n">dim</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">sobol</span> <span class="o">=</span> <span class="n">SobolEngine</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">scramble</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">pert</span> <span class="o">=</span> <span class="n">sobol</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">n_candidates</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
        <span class="n">pert</span> <span class="o">=</span> <span class="n">tr_lb</span> <span class="o">+</span> <span class="p">(</span><span class="n">tr_ub</span> <span class="o">-</span> <span class="n">tr_lb</span><span class="p">)</span> <span class="o">*</span> <span class="n">pert</span>

        <span class="c1"># Create a perturbation mask</span>
        <span class="n">prob_perturb</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">20.0</span> <span class="o">/</span> <span class="n">dim</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n_candidates</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
            <span class="o">&lt;=</span> <span class="n">prob_perturb</span>
        <span class="p">)</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">mask</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">),),</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1"># Create candidate points from the perturbations and the mask        </span>
        <span class="n">X_cand</span> <span class="o">=</span> <span class="n">x_center</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">n_candidates</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
        <span class="n">X_cand</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">pert</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>

        <span class="c1"># Sample on the candidate points</span>
        <span class="n">thompson_sampling</span> <span class="o">=</span> <span class="n">MaxPosteriorSampling</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">replacement</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>  <span class="c1"># We don't need gradients when using TS</span>
            <span class="n">X_next</span> <span class="o">=</span> <span class="n">thompson_sampling</span><span class="p">(</span><span class="n">X_cand</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">acqf</span> <span class="o">==</span> <span class="s2">"ei"</span><span class="p">:</span>
        <span class="n">ei</span> <span class="o">=</span> <span class="n">qExpectedImprovement</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train_Y</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">maximize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">X_next</span><span class="p">,</span> <span class="n">acq_value</span> <span class="o">=</span> <span class="n">optimize_acqf</span><span class="p">(</span>
            <span class="n">ei</span><span class="p">,</span>
            <span class="n">bounds</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tr_lb</span><span class="p">,</span> <span class="n">tr_ub</span><span class="p">]),</span>
            <span class="n">q</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
            <span class="n">num_restarts</span><span class="o">=</span><span class="n">num_restarts</span><span class="p">,</span>
            <span class="n">raw_samples</span><span class="o">=</span><span class="n">raw_samples</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">X_next</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Optimization-loop">Optimization loop<a class="anchor-link" href="#Optimization-loop">¶</a></h2><p>This simple loop runs one instance of TuRBO-1 with Thompson sampling until convergence.</p>
<p>TuRBO-1 is a local optimizer that can be used for a fixed evaluation budget in a multi-start fashion.  Once TuRBO converges, <code>state["restart_triggered"]</code> will be set to true and the run should be aborted.  If you want to run more evaluations with TuRBO, you simply generate a new set of initial points and then keep generating batches until convergence or when the evaluation budget has been exceeded.  It's important to note that evaluations from previous instances are discarded when TuRBO restarts.</p>
<p>NOTE: We use a <code>SingleTaskGP</code> with a noise constraint to keep the noise from getting too large as the problem is noise-free.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">X_turbo</span> <span class="o">=</span> <span class="n">get_initial_points</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">n_init</span><span class="p">)</span>
<span class="n">Y_turbo</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span>
    <span class="p">[</span><span class="n">eval_objective</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">X_turbo</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span>
<span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">state</span> <span class="o">=</span> <span class="n">TurboState</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>

<span class="n">NUM_RESTARTS</span> <span class="o">=</span> <span class="mi">10</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">SMOKE_TEST</span> <span class="k">else</span> <span class="mi">2</span>
<span class="n">RAW_SAMPLES</span> <span class="o">=</span> <span class="mi">512</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">SMOKE_TEST</span> <span class="k">else</span> <span class="mi">4</span>
<span class="n">N_CANDIDATES</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">200</span> <span class="o">*</span> <span class="n">dim</span><span class="p">))</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">SMOKE_TEST</span> <span class="k">else</span> <span class="mi">4</span>


<span class="k">while</span> <span class="ow">not</span> <span class="n">state</span><span class="o">.</span><span class="n">restart_triggered</span><span class="p">:</span>  <span class="c1"># Run until TuRBO converges</span>
    <span class="c1"># Fit a GP model</span>
    <span class="n">train_Y</span> <span class="o">=</span> <span class="p">(</span><span class="n">Y_turbo</span> <span class="o">-</span> <span class="n">Y_turbo</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">Y_turbo</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    <span class="n">likelihood</span> <span class="o">=</span> <span class="n">GaussianLikelihood</span><span class="p">(</span><span class="n">noise_constraint</span><span class="o">=</span><span class="n">Interval</span><span class="p">(</span><span class="mf">1e-8</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">))</span>
    <span class="n">covar_module</span> <span class="o">=</span> <span class="n">ScaleKernel</span><span class="p">(</span>  <span class="c1"># Use the same lengthscale prior as in the TuRBO paper</span>
        <span class="n">MaternKernel</span><span class="p">(</span><span class="n">nu</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">ard_num_dims</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span> <span class="n">lengthscale_constraint</span><span class="o">=</span><span class="n">Interval</span><span class="p">(</span><span class="mf">0.005</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">))</span>
    <span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">SingleTaskGP</span><span class="p">(</span><span class="n">X_turbo</span><span class="p">,</span> <span class="n">train_Y</span><span class="p">,</span> <span class="n">covar_module</span><span class="o">=</span><span class="n">covar_module</span><span class="p">,</span> <span class="n">likelihood</span><span class="o">=</span><span class="n">likelihood</span><span class="p">)</span>
    <span class="n">mll</span> <span class="o">=</span> <span class="n">ExactMarginalLogLikelihood</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">likelihood</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>

    <span class="c1"># Do the fitting and acquisition function optimization inside the Cholesky context</span>
    <span class="k">with</span> <span class="n">gpytorch</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">max_cholesky_size</span><span class="p">(</span><span class="n">max_cholesky_size</span><span class="p">):</span>
        <span class="c1"># Fit the model</span>
        <span class="n">fit_gpytorch_mll</span><span class="p">(</span><span class="n">mll</span><span class="p">)</span>
    
        <span class="c1"># Create a batch</span>
        <span class="n">X_next</span> <span class="o">=</span> <span class="n">generate_batch</span><span class="p">(</span>
            <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span>
            <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
            <span class="n">X</span><span class="o">=</span><span class="n">X_turbo</span><span class="p">,</span>
            <span class="n">Y</span><span class="o">=</span><span class="n">train_Y</span><span class="p">,</span>
            <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
            <span class="n">n_candidates</span><span class="o">=</span><span class="n">N_CANDIDATES</span><span class="p">,</span>
            <span class="n">num_restarts</span><span class="o">=</span><span class="n">NUM_RESTARTS</span><span class="p">,</span>
            <span class="n">raw_samples</span><span class="o">=</span><span class="n">RAW_SAMPLES</span><span class="p">,</span>
            <span class="n">acqf</span><span class="o">=</span><span class="s2">"ts"</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">Y_next</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span>
        <span class="p">[</span><span class="n">eval_objective</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">X_next</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span>
    <span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Update state</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">update_state</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span> <span class="n">Y_next</span><span class="o">=</span><span class="n">Y_next</span><span class="p">)</span>

    <span class="c1"># Append data</span>
    <span class="n">X_turbo</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">X_turbo</span><span class="p">,</span> <span class="n">X_next</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">Y_turbo</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">Y_turbo</span><span class="p">,</span> <span class="n">Y_next</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Print current status</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X_turbo</span><span class="p">)</span><span class="si">}</span><span class="s2">) Best value: </span><span class="si">{</span><span class="n">state</span><span class="o">.</span><span class="n">best_value</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">, TR length: </span><span class="si">{</span><span class="n">state</span><span class="o">.</span><span class="n">length</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">"</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>44) Best value: -1.11e+01, TR length: 8.00e-01
48) Best value: -1.08e+01, TR length: 8.00e-01
52) Best value: -1.01e+01, TR length: 8.00e-01
56) Best value: -1.01e+01, TR length: 8.00e-01
60) Best value: -1.01e+01, TR length: 8.00e-01
64) Best value: -9.05e+00, TR length: 8.00e-01
68) Best value: -9.05e+00, TR length: 8.00e-01
72) Best value: -9.05e+00, TR length: 8.00e-01
76) Best value: -9.05e+00, TR length: 8.00e-01
80) Best value: -9.05e+00, TR length: 8.00e-01
84) Best value: -8.11e+00, TR length: 8.00e-01
88) Best value: -7.41e+00, TR length: 8.00e-01
92) Best value: -7.41e+00, TR length: 8.00e-01
96) Best value: -7.41e+00, TR length: 8.00e-01
100) Best value: -7.41e+00, TR length: 8.00e-01
104) Best value: -7.41e+00, TR length: 8.00e-01
108) Best value: -7.41e+00, TR length: 4.00e-01
112) Best value: -6.57e+00, TR length: 4.00e-01
116) Best value: -6.27e+00, TR length: 4.00e-01
120) Best value: -6.24e+00, TR length: 4.00e-01
124) Best value: -5.58e+00, TR length: 4.00e-01
128) Best value: -5.58e+00, TR length: 4.00e-01
132) Best value: -5.57e+00, TR length: 4.00e-01
136) Best value: -5.57e+00, TR length: 4.00e-01
140) Best value: -5.57e+00, TR length: 4.00e-01
144) Best value: -5.57e+00, TR length: 4.00e-01
148) Best value: -5.57e+00, TR length: 4.00e-01
152) Best value: -5.33e+00, TR length: 4.00e-01
156) Best value: -5.32e+00, TR length: 4.00e-01
160) Best value: -5.32e+00, TR length: 4.00e-01
164) Best value: -5.32e+00, TR length: 4.00e-01
168) Best value: -5.32e+00, TR length: 4.00e-01
172) Best value: -5.32e+00, TR length: 2.00e-01
176) Best value: -4.98e+00, TR length: 2.00e-01
180) Best value: -4.27e+00, TR length: 2.00e-01
184) Best value: -4.04e+00, TR length: 2.00e-01
188) Best value: -4.04e+00, TR length: 2.00e-01
192) Best value: -4.04e+00, TR length: 2.00e-01
196) Best value: -4.04e+00, TR length: 2.00e-01
200) Best value: -4.04e+00, TR length: 2.00e-01
204) Best value: -4.02e+00, TR length: 2.00e-01
208) Best value: -4.02e+00, TR length: 2.00e-01
212) Best value: -3.90e+00, TR length: 2.00e-01
216) Best value: -3.90e+00, TR length: 2.00e-01
220) Best value: -3.84e+00, TR length: 2.00e-01
224) Best value: -3.84e+00, TR length: 2.00e-01
228) Best value: -3.84e+00, TR length: 2.00e-01
232) Best value: -3.84e+00, TR length: 2.00e-01
236) Best value: -3.84e+00, TR length: 2.00e-01
240) Best value: -3.84e+00, TR length: 1.00e-01
244) Best value: -3.65e+00, TR length: 1.00e-01
248) Best value: -3.35e+00, TR length: 1.00e-01
252) Best value: -3.35e+00, TR length: 1.00e-01
256) Best value: -3.03e+00, TR length: 1.00e-01
260) Best value: -3.03e+00, TR length: 1.00e-01
264) Best value: -3.03e+00, TR length: 1.00e-01
268) Best value: -2.74e+00, TR length: 1.00e-01
272) Best value: -2.74e+00, TR length: 1.00e-01
276) Best value: -2.74e+00, TR length: 1.00e-01
280) Best value: -2.74e+00, TR length: 1.00e-01
284) Best value: -2.52e+00, TR length: 1.00e-01
288) Best value: -2.52e+00, TR length: 1.00e-01
292) Best value: -2.49e+00, TR length: 1.00e-01
296) Best value: -2.49e+00, TR length: 1.00e-01
300) Best value: -2.49e+00, TR length: 1.00e-01
304) Best value: -2.49e+00, TR length: 1.00e-01
308) Best value: -2.49e+00, TR length: 1.00e-01
312) Best value: -2.49e+00, TR length: 5.00e-02
316) Best value: -2.09e+00, TR length: 5.00e-02
320) Best value: -2.09e+00, TR length: 5.00e-02
324) Best value: -2.09e+00, TR length: 5.00e-02
328) Best value: -1.83e+00, TR length: 5.00e-02
332) Best value: -1.83e+00, TR length: 5.00e-02
336) Best value: -1.83e+00, TR length: 5.00e-02
340) Best value: -1.81e+00, TR length: 5.00e-02
344) Best value: -1.81e+00, TR length: 5.00e-02
348) Best value: -1.81e+00, TR length: 5.00e-02
352) Best value: -1.81e+00, TR length: 5.00e-02
356) Best value: -1.81e+00, TR length: 5.00e-02
360) Best value: -1.81e+00, TR length: 2.50e-02
364) Best value: -1.38e+00, TR length: 2.50e-02
368) Best value: -1.38e+00, TR length: 2.50e-02
372) Best value: -1.38e+00, TR length: 2.50e-02
376) Best value: -1.38e+00, TR length: 2.50e-02
380) Best value: -1.11e+00, TR length: 2.50e-02
384) Best value: -1.11e+00, TR length: 2.50e-02
388) Best value: -1.11e+00, TR length: 2.50e-02
392) Best value: -1.11e+00, TR length: 2.50e-02
396) Best value: -1.11e+00, TR length: 2.50e-02
400) Best value: -1.11e+00, TR length: 1.25e-02
404) Best value: -9.81e-01, TR length: 1.25e-02
408) Best value: -8.63e-01, TR length: 1.25e-02
412) Best value: -8.63e-01, TR length: 1.25e-02
416) Best value: -8.63e-01, TR length: 1.25e-02
420) Best value: -8.63e-01, TR length: 1.25e-02
424) Best value: -8.63e-01, TR length: 1.25e-02
428) Best value: -8.63e-01, TR length: 6.25e-03
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="GP-EI">GP-EI<a class="anchor-link" href="#GP-EI">¶</a></h2><p>As a baseline, we compare TuRBO to qEI</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">X_ei</span> <span class="o">=</span> <span class="n">get_initial_points</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">n_init</span><span class="p">)</span>
<span class="n">Y_ei</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span>
    <span class="p">[</span><span class="n">eval_objective</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">X_ei</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span>
<span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y_ei</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y_turbo</span><span class="p">):</span>
    <span class="n">train_Y</span> <span class="o">=</span> <span class="p">(</span><span class="n">Y_ei</span> <span class="o">-</span> <span class="n">Y_ei</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">Y_ei</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    <span class="n">likelihood</span> <span class="o">=</span> <span class="n">GaussianLikelihood</span><span class="p">(</span><span class="n">noise_constraint</span><span class="o">=</span><span class="n">Interval</span><span class="p">(</span><span class="mf">1e-8</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">))</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">SingleTaskGP</span><span class="p">(</span><span class="n">X_ei</span><span class="p">,</span> <span class="n">train_Y</span><span class="p">,</span> <span class="n">likelihood</span><span class="o">=</span><span class="n">likelihood</span><span class="p">)</span>
    <span class="n">mll</span> <span class="o">=</span> <span class="n">ExactMarginalLogLikelihood</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">likelihood</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
    <span class="n">fit_gpytorch_mll</span><span class="p">(</span><span class="n">mll</span><span class="p">)</span>

    <span class="c1"># Create a batch</span>
    <span class="n">ei</span> <span class="o">=</span> <span class="n">qExpectedImprovement</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train_Y</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">maximize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">candidate</span><span class="p">,</span> <span class="n">acq_value</span> <span class="o">=</span> <span class="n">optimize_acqf</span><span class="p">(</span>
        <span class="n">ei</span><span class="p">,</span>
        <span class="n">bounds</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">),</span>
                <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="p">),</span>
        <span class="n">q</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
        <span class="n">num_restarts</span><span class="o">=</span><span class="n">NUM_RESTARTS</span><span class="p">,</span>
        <span class="n">raw_samples</span><span class="o">=</span><span class="n">RAW_SAMPLES</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">Y_next</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span>
        <span class="p">[</span><span class="n">eval_objective</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidate</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span>
    <span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Append data</span>
    <span class="n">X_ei</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">X_ei</span><span class="p">,</span> <span class="n">candidate</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">Y_ei</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">Y_ei</span><span class="p">,</span> <span class="n">Y_next</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Print current status</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X_ei</span><span class="p">)</span><span class="si">}</span><span class="s2">) Best value: </span><span class="si">{</span><span class="n">Y_ei</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>44) Best value: -1.12e+01
48) Best value: -1.06e+01
52) Best value: -9.38e+00
56) Best value: -9.38e+00
60) Best value: -8.60e+00
64) Best value: -8.60e+00
68) Best value: -8.60e+00
72) Best value: -8.60e+00
76) Best value: -8.60e+00
80) Best value: -8.60e+00
84) Best value: -8.60e+00
88) Best value: -8.60e+00
92) Best value: -8.60e+00
96) Best value: -8.60e+00
100) Best value: -8.60e+00
104) Best value: -8.60e+00
108) Best value: -8.60e+00
112) Best value: -8.60e+00
116) Best value: -8.60e+00
120) Best value: -8.60e+00
124) Best value: -8.60e+00
128) Best value: -8.60e+00
132) Best value: -8.60e+00
136) Best value: -8.60e+00
140) Best value: -8.60e+00
144) Best value: -8.60e+00
148) Best value: -8.60e+00
152) Best value: -8.60e+00
156) Best value: -8.60e+00
160) Best value: -8.60e+00
164) Best value: -8.60e+00
168) Best value: -8.60e+00
172) Best value: -8.60e+00
176) Best value: -8.60e+00
180) Best value: -8.60e+00
184) Best value: -8.60e+00
188) Best value: -8.60e+00
192) Best value: -8.60e+00
196) Best value: -8.60e+00
200) Best value: -8.60e+00
204) Best value: -8.60e+00
208) Best value: -8.60e+00
212) Best value: -8.60e+00
216) Best value: -8.60e+00
220) Best value: -8.60e+00
224) Best value: -8.60e+00
228) Best value: -8.60e+00
232) Best value: -8.60e+00
236) Best value: -8.60e+00
240) Best value: -8.60e+00
244) Best value: -8.60e+00
248) Best value: -8.60e+00
252) Best value: -8.60e+00
256) Best value: -8.60e+00
260) Best value: -8.60e+00
264) Best value: -8.60e+00
268) Best value: -8.60e+00
272) Best value: -8.60e+00
276) Best value: -8.60e+00
280) Best value: -8.60e+00
284) Best value: -8.60e+00
288) Best value: -8.60e+00
292) Best value: -8.60e+00
296) Best value: -8.60e+00
300) Best value: -8.60e+00
304) Best value: -8.60e+00
308) Best value: -8.60e+00
312) Best value: -8.60e+00
316) Best value: -8.60e+00
320) Best value: -8.60e+00
324) Best value: -8.60e+00
328) Best value: -8.60e+00
332) Best value: -8.60e+00
336) Best value: -8.60e+00
340) Best value: -8.60e+00
344) Best value: -8.60e+00
348) Best value: -8.60e+00
352) Best value: -8.60e+00
356) Best value: -8.60e+00
360) Best value: -8.60e+00
364) Best value: -8.60e+00
368) Best value: -8.60e+00
372) Best value: -8.60e+00
376) Best value: -8.60e+00
380) Best value: -8.60e+00
384) Best value: -8.60e+00
388) Best value: -8.60e+00
392) Best value: -8.60e+00
396) Best value: -8.60e+00
400) Best value: -8.60e+00
404) Best value: -8.60e+00
408) Best value: -8.60e+00
412) Best value: -8.60e+00
416) Best value: -8.60e+00
420) Best value: -8.60e+00
424) Best value: -8.60e+00
428) Best value: -8.60e+00
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Sobol">Sobol<a class="anchor-link" href="#Sobol">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">X_Sobol</span> <span class="o">=</span> <span class="n">SobolEngine</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">scramble</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_turbo</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<span class="n">Y_Sobol</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">eval_objective</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">X_Sobol</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Compare-the-methods">Compare the methods<a class="anchor-link" href="#Compare-the-methods">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rc</span>

<span class="o">%</span><span class="k">matplotlib</span> inline


<span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"TuRBO-1"</span><span class="p">,</span> <span class="s2">"EI"</span><span class="p">,</span> <span class="s2">"Sobol"</span><span class="p">]</span>
<span class="n">runs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Y_turbo</span><span class="p">,</span> <span class="n">Y_ei</span><span class="p">,</span> <span class="n">Y_Sobol</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">run</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">runs</span><span class="p">):</span>
    <span class="n">fx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">cpu</span><span class="p">())</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fx</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y_turbo</span><span class="p">)],</span> <span class="p">[</span><span class="n">fun</span><span class="o">.</span><span class="n">optimal_value</span><span class="p">,</span> <span class="n">fun</span><span class="o">.</span><span class="n">optimal_value</span><span class="p">],</span> <span class="s2">"k--"</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"Function value"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"Number of evaluations"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"20D Ackley"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y_turbo</span><span class="p">)])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
    <span class="n">names</span> <span class="o">+</span> <span class="p">[</span><span class="s2">"Global optimal value"</span><span class="p">],</span>
    <span class="n">loc</span><span class="o">=</span><span class="s2">"lower center"</span><span class="p">,</span>
    <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.08</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">bbox_transform</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">transFigure</span><span class="p">,</span>
    <span class="n">ncol</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea">
<img src="data:image/png;base64,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HCMQCPC+FIm9e/f677zzzmUPPPDAqR07dryzZcuWno6Ojt6enp7KW2+9ta23t7dKivw8ffWrXz2T7nE3bNjQf9ttt53NpG6zLTNT27dvvyh+XXt7e7C9vT2YaPtsyEcb8/06JlN2ASf6V8JMli9fntZ2yXR2dtbM5jhHjx5tXLly5UD08bZt25bceOONve5f7G433XRT75YtW5ZlUkdkx969e2Mhds2aNYOFrIsXnT59uvbQoUMN7nUbNmzoT/dnGcWjs7Oz5mtf+9qyffv2dcX/btuwYUP/Bz/4wbSG3pMptSD78ssvN8av27BhQ3+6UxCQWtnNwVm7dm1aX0AtLS3hj33sY5dLkS62np6eyq9+9atLn3jiiZZTp079MlnwkCK9L4888sjC3bt3d830QY121X7pS1962z2M8Ytf/KL5ox/9aNK/Uk3THHz00UdTXgMAudfT01P51FNP+aO9gul+vpC+L37xi2c+8YlPXLlx48aeT37yk32f/vSn+1paWsLu1zo618w9Vy1+WLCvr68yGkaDwWClFOlpnc0xkJk777xzWao/3Nrb24PRHhyvu+uuu5YUug5eN+cP0nu2H1ydzYpk4nc71h3O9jGjXWwPPPDAIikSeB577LGTTzzxREui7V9++eXGvXv3hiXpqaee8n/84x/vSzYU5t5WkqLj0NHHPT09lZIU/UWbiN/vH5ciYarUvlRr72stms/OyDe65/TZ+dnPfta8fft2BYPBqhdeeKE52/XKNvNHZtG85tZnrVm95g899NDptra2kccee2xh9Odv48aNPe45CuvXr7/iwIEDx6JfnHv37vXfdttty9zbvPnmm7Xun8nbbrtt2YMPPhgLOekco1j82Z/92cUPPfTQ4nS2veWWW3oef/zxKW249dZblz355JMJf5fFu+uuu97+1re+9ZZ73c9//vOGD33oQ7P+vfOLX/yi+eabb076em7YsKE/+vsvkWwE2UOHDjX09PRU9vb2VlmW1bB+/fq+2faYpKqHey7Qxz/+8b5AIBC2LKuhra1tJFqP/fv3N508ebL26NGjDdu3b7/I5/OFt2zZ0hM/dyX6uLm5OXzHHXeclaTDhw83+Hy+8I033tj34osvNgaDwcqXX3650f05zUYb9+7d67/nnnuWSNLjjz/etXbt2sG9e/f6v/a1ry278cYbe++8886z6ZYR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
"/>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div></div><div class="tutorialButtonWrapper buttonWrapper"><a class="tutorialButton button" download="" href="/files/turbo_1.ipynb" target="_blank"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="file-download" class="svg-inline--fa fa-file-download fa-w-12" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm76.45 211.36l-96.42 95.7c-6.65 6.61-17.39 6.61-24.04 0l-96.42-95.7C73.42 337.29 80.54 320 94.82 320H160v-80c0-8.84 7.16-16 16-16h32c8.84 0 16 7.16 16 16v80h65.18c14.28 0 21.4 17.29 11.27 27.36zM377 105L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9z"></path></svg>Download Tutorial Jupyter Notebook</a></div><div class="tutorialButtonWrapper buttonWrapper"><a class="tutorialButton button" download="" href="/files/turbo_1.py" target="_blank"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="file-download" class="svg-inline--fa fa-file-download fa-w-12" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm76.45 211.36l-96.42 95.7c-6.65 6.61-17.39 6.61-24.04 0l-96.42-95.7C73.42 337.29 80.54 320 94.82 320H160v-80c0-8.84 7.16-16 16-16h32c8.84 0 16 7.16 16 16v80h65.18c14.28 0 21.4 17.29 11.27 27.36zM377 105L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9z"></path></svg>Download Tutorial Source Code</a></div></div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/botorch.png" alt="BoTorch" width="66" height="58"/></a><div class="footerSection"><h5>Docs</h5><a href="/docs/introduction">Introduction</a><a href="/docs/getting_started">Getting Started</a><a href="/tutorials/">Tutorials</a><a href="/api/">API Reference</a><a href="https://arxiv.org/abs/1910.06403">Paper</a></div><div class="footerSection"><h5>Legal</h5><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noreferrer noopener">Privacy</a><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noreferrer noopener">Terms</a></div><div class="footerSection"><h5>Social</h5><div class="social"><a class="github-button" href="https://github.com/pytorch/botorch" data-count-href="https://github.com/pytorch/botorch/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star BoTorch on GitHub">botorch</a></div></div></section><a href="https://opensource.facebook.com/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/img/oss_logo.png" alt="Meta Open Source" width="300" height="25"/></a><section class="copyright"> Copyright © 2022 Meta Platforms, Inc</section><script>
            (function() {
              var BAD_BASE = '/botorch/';
              if (window.location.origin !== 'https://botorch.org') {
                var pathname = window.location.pathname;
                var newPathname = pathname.slice(pathname.indexOf(BAD_BASE) === 0 ? BAD_BASE.length : 1);
                var newLocation = 'https://botorch.org/' + newPathname;
                console.log('redirecting to ' + newLocation);
                window.location.href = newLocation;
              }
            })();
          </script></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '207c27d819f967749142d8611de7cb19',
                indexName: 'botorch',
                inputSelector: '#search_input_react'
              });
            </script></body></html>