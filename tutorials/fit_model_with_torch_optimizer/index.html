<!DOCTYPE html><html lang=""><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>BoTorch · Bayesian Optimization in PyTorch</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="Bayesian Optimization in PyTorch"/><meta property="og:title" content="BoTorch · Bayesian Optimization in PyTorch"/><meta property="og:type" content="website"/><meta property="og:url" content="https://botorch.org/"/><meta property="og:description" content="Bayesian Optimization in PyTorch"/><meta property="og:image" content="https://botorch.org/img/botorch.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://botorch.org/img/botorch.png"/><link rel="shortcut icon" href="/img/botorch.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-139570076-2', 'auto');
              ga('send', 'pageview');
            </script><link rel="stylesheet" href="/css/code_block_buttons.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="/js/code_block_buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/mathjax.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/botorch_logo_lockup_white.png" alt="BoTorch"/><h2 class="headerTitleWithLogo">BoTorch</h2></a><a href="/versions"><h3>stable</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/docs/introduction" target="_self">Docs</a></li><li class=""><a href="/tutorials/" target="_self">Tutorials</a></li><li class=""><a href="/api/" target="_self">API Reference</a></li><li class=""><a href="/docs/papers" target="_self">Papers</a></li><li class=""><a href="https://github.com/pytorch/botorch" target="_self">GitHub</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span></span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Tutorials</h3><ul class=""><li class="navListItem"><a class="navItem" href="/tutorials/">Overview</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Using BoTorch with Ax</h3><ul class=""><li class="navListItem"><a class="navItem" href="/tutorials/custom_botorch_model_in_ax">Using a custom BoTorch model</a></li><li class="navListItem"><a class="navItem" href="/tutorials/custom_acquisition">Writing a custom acquisition function</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Full Optimization Loops</h3><ul class=""><li class="navListItem"><a class="navItem" href="/tutorials/closed_loop_botorch_only">q-Noisy Constrained EI</a></li><li class="navListItem"><a class="navItem" href="/tutorials/preference_bo">Bayesian optimization with pairwise comparison data</a></li><li class="navListItem"><a class="navItem" href="/tutorials/turbo_1">Trust Region Bayesian Optimization (TuRBO)</a></li><li class="navListItem"><a class="navItem" href="/tutorials/bo_with_warped_gp">Bayesian optimization with input warping</a></li><li class="navListItem"><a class="navItem" href="/tutorials/thompson_sampling">Bayesian optimization with large-scale Thompson sampling</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Multi-Objective Bayesian Optimization</h3><ul class=""><li class="navListItem"><a class="navItem" href="/tutorials/multi_objective_bo">Multi-objective optimization with qEHVI, qNEHVI, and qNParEGO</a></li><li class="navListItem"><a class="navItem" href="/tutorials/constrained_multi_objective_bo">Constrained multi-objective optimization with qNEHVI and qParEGO</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Bite-Sized Tutorials</h3><ul class=""><li class="navListItem navListItemActive"><a class="navItem" href="/tutorials/fit_model_with_torch_optimizer">Fitting a model using torch.optim</a></li><li class="navListItem"><a class="navItem" href="/tutorials/compare_mc_analytic_acquisition">Comparing analytic and MC Expected Improvement</a></li><li class="navListItem"><a class="navItem" href="/tutorials/optimize_with_cmaes">Acquisition function optimization with CMA-ES</a></li><li class="navListItem"><a class="navItem" href="/tutorials/optimize_stochastic">Acquisition function optimization with torch.optim</a></li><li class="navListItem"><a class="navItem" href="/tutorials/batch_mode_cross_validation">Using batch evaluation for fast cross-validation</a></li><li class="navListItem"><a class="navItem" href="/tutorials/one_shot_kg">The one-shot Knowledge Gradient acquisition function</a></li><li class="navListItem"><a class="navItem" href="/tutorials/max_value_entropy">The max-value entropy search acquisition function</a></li><li class="navListItem"><a class="navItem" href="/tutorials/GIBBON_for_efficient_batch_entropy_search">The GIBBON acquisition function for efficient batch entropy search</a></li><li class="navListItem"><a class="navItem" href="/tutorials/risk_averse_bo_with_environmental_variables">Risk averse Bayesian optimization with environmental variables</a></li><li class="navListItem"><a class="navItem" href="/tutorials/risk_averse_bo_with_input_perturbations">Risk averse Bayesian optimization with input perturbations</a></li><li class="navListItem"><a class="navItem" href="/tutorials/constraint_active_search">Constraint Active Search for Multiobjective Experimental Design</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Advanced Usage</h3><ul class=""><li class="navListItem"><a class="navItem" href="/tutorials/meta_learning_with_rgpe">Meta-learning with RGPE</a></li><li class="navListItem"><a class="navItem" href="/tutorials/vae_mnist">High-dimensional optimization with VAEs</a></li><li class="navListItem"><a class="navItem" href="/tutorials/multi_fidelity_bo">Multi-fidelity Bayesian optimization using KG</a></li><li class="navListItem"><a class="navItem" href="/tutorials/discrete_multi_fidelity_bo">Multi-fidelity Bayesian optimization with discrete fidelities using KG</a></li><li class="navListItem"><a class="navItem" href="/tutorials/composite_bo_with_hogp">Composite Bayesian optimization with the High Order Gaussian Process</a></li><li class="navListItem"><a class="navItem" href="/tutorials/composite_mtbo">Composite Bayesian Optimization with Multi-Task Gaussian Processes</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="tutorialBody">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<div class="notebook">
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Fitting-models-in-BoTorch-with-a-torch.optim.Optimizer">Fitting models in BoTorch with a torch.optim.Optimizer<a class="anchor-link" href="#Fitting-models-in-BoTorch-with-a-torch.optim.Optimizer">¶</a></h2><p>BoTorch provides a convenient <code>botorch.fit.fit_gpytorch_model</code> function with sensible defaults that work on most basic models, including those that botorch ships with. Internally, this function uses L-BFGS-B to fit the parameters. However, in more advanced use cases you may need or want to implement your own model fitting logic.</p>
<p>This tutorial allows you to customize model fitting to your needs using the familiar PyTorch-style model fitting loop.</p>
<p>This tutorial is adapted from GPyTorch's <a href="https://github.com/cornellius-gp/gpytorch/blob/master/examples/01_Exact_GPs/Simple_GP_Regression.ipynb">Simple GP Regression Tutorial</a> and has very few changes because the out-of-the box models that BoTorch provides are GPyTorch models; in fact, they are proper subclasses that add the <code>botorch.models.Model</code> API functions.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">torch</span>

<span class="c1"># use a GPU if available</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">"cuda"</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">"cpu"</span><span class="p">)</span>
<span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">float</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Set-up-function-to-model">Set up function to model<a class="anchor-link" href="#Set-up-function-to-model">¶</a></h3><p>In this tutorial we will model a simple sinusoidal function with i.i.d. Gaussian noise:</p>
$$y = \sin(2\pi x) + \epsilon, ~\epsilon \sim \mathcal N(0, 0.15)$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Initialize-training-data">Initialize training data<a class="anchor-link" href="#Initialize-training-data">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># use regular spaced points on the interval [0, 1]</span>
<span class="n">train_X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<span class="c1"># training data needs to be explicitly multi-dimensional</span>
<span class="n">train_X</span> <span class="o">=</span> <span class="n">train_X</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># sample observed values and add some synthetic noise</span>
<span class="n">train_Y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">train_X</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">+</span> <span class="mf">0.15</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn_like</span><span class="p">(</span><span class="n">train_X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Initialize-the-model">Initialize the model<a class="anchor-link" href="#Initialize-the-model">¶</a></h4><p>We will model the function using a <code>SingleTaskGP</code>, which by default uses a <code>GaussianLikelihood</code> and infers the unknown noise level.</p>
<p>The default optimizer for the <code>SingleTaskGP</code> is L-BFGS-B, which takes as input explicit bounds on the noise parameter. However, the <code>torch</code> optimizers don't support parameter bounds as input. To use the <code>torch</code> optimizers, then, we'll need to manually register a constraint on the noise level. When registering a constraint, the <code>softplus</code> transform is applied by default, enabling us to enforce a lower bound on the noise.</p>
<p><strong>Note</strong>: Without manual registration, the model itself does not apply any constraints, due to the interaction between constraints and transforms. Although the <code>SingleTaskGP</code> constructor does in fact define a constraint, the constructor sets <code>transform=None</code>, which means that the constraint is not enforced. See the <a href="https://github.com/cornellius-gp/gpytorch/blob/master/gpytorch/constraints/constraints.py">GPyTorch constraints module</a> for additional information.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">botorch.models</span> <span class="kn">import</span> <span class="n">SingleTaskGP</span>
<span class="kn">from</span> <span class="nn">gpytorch.constraints</span> <span class="kn">import</span> <span class="n">GreaterThan</span>


<span class="n">model</span> <span class="o">=</span> <span class="n">SingleTaskGP</span><span class="p">(</span><span class="n">train_X</span><span class="o">=</span><span class="n">train_X</span><span class="p">,</span> <span class="n">train_Y</span><span class="o">=</span><span class="n">train_Y</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">likelihood</span><span class="o">.</span><span class="n">noise_covar</span><span class="o">.</span><span class="n">register_constraint</span><span class="p">(</span><span class="s2">"raw_noise"</span><span class="p">,</span> <span class="n">GreaterThan</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Define-marginal-log-likelihood">Define marginal log likelihood<a class="anchor-link" href="#Define-marginal-log-likelihood">¶</a></h4><p>We will jointly optimize the kernel hyperparameters and the likelihood's noise parameter, by minimizing the negative <code>gpytorch.mlls.ExactMarginalLogLikelihood</code> (our loss function).</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">gpytorch.mlls</span> <span class="kn">import</span> <span class="n">ExactMarginalLogLikelihood</span>

<span class="n">mll</span> <span class="o">=</span> <span class="n">ExactMarginalLogLikelihood</span><span class="p">(</span><span class="n">likelihood</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">likelihood</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">)</span>
<span class="c1"># set mll and all submodules to the specified dtype and device</span>
<span class="n">mll</span> <span class="o">=</span> <span class="n">mll</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">train_X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Define-optimizer-and-specify-parameters-to-optimize">Define optimizer and specify parameters to optimize<a class="anchor-link" href="#Define-optimizer-and-specify-parameters-to-optimize">¶</a></h4><p>We will use stochastic gradient descent (<code>torch.optim.SGD</code>) to optimize the kernel hyperparameters and the noise level. In this example, we will use a simple fixed learning rate of 0.1, but in practice the learning rate may need to be adjusted.</p>
<p>Notes:</p>
<ul>
<li>As the <code>GaussianLikelihood</code> module is a of child (submodule) of the <code>SingleTaskGP</code> moduel, <code>model.parameters()</code> will also include the noise level of the <code>GaussianLikelihood</code>. </li>
<li>A subset of the parameters could be passed to the optimizer to tune those parameters, while leaving the other parameters fixed.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">torch.optim</span> <span class="kn">import</span> <span class="n">SGD</span>

<span class="n">optimizer</span> <span class="o">=</span> <span class="n">SGD</span><span class="p">([{</span><span class="s1">'params'</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">()}],</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Fit-model-hyperparameters-and-noise-level">Fit model hyperparameters and noise level<a class="anchor-link" href="#Fit-model-hyperparameters-and-noise-level">¶</a></h4><p>Now we are ready to write our optimization loop. We will perform 150 epochs of stochastic gradient descent using our entire training set.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">NUM_EPOCHS</span> <span class="o">=</span> <span class="mi">150</span>

<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>

<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NUM_EPOCHS</span><span class="p">):</span>
    <span class="c1"># clear gradients</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="c1"># forward pass through the model to obtain the output MultivariateNormal</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">train_X</span><span class="p">)</span>
    <span class="c1"># Compute negative marginal log likelihood</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="o">-</span> <span class="n">mll</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">train_targets</span><span class="p">)</span>
    <span class="c1"># back prop gradients</span>
    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="c1"># print every 10 iterations</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">epoch</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">"Epoch </span><span class="si">{</span><span class="n">epoch</span><span class="o">+</span><span class="mi">1</span><span class="si">:</span><span class="s2">&gt;3</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">NUM_EPOCHS</span><span class="si">}</span><span class="s2"> - Loss: </span><span class="si">{</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">:</span><span class="s2">&gt;4.3f</span><span class="si">}</span><span class="s2"> "</span>
            <span class="sa">f</span><span class="s2">"lengthscale: </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">covar_module</span><span class="o">.</span><span class="n">base_kernel</span><span class="o">.</span><span class="n">lengthscale</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">:</span><span class="s2">&gt;4.3f</span><span class="si">}</span><span class="s2"> "</span> 
            <span class="sa">f</span><span class="s2">"noise: </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">likelihood</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">:</span><span class="s2">&gt;4.3f</span><span class="si">}</span><span class="s2">"</span> 
         <span class="p">)</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch  10/150 - Loss: 1.966 lengthscale: 0.645 noise: 2.005
Epoch  20/150 - Loss: 1.930 lengthscale: 0.599 noise: 1.868
Epoch  30/150 - Loss: 1.894 lengthscale: 0.560 noise: 1.730
Epoch  40/150 - Loss: 1.857 lengthscale: 0.527 noise: 1.590
Epoch  50/150 - Loss: 1.819 lengthscale: 0.497 noise: 1.449
Epoch  60/150 - Loss: 1.779 lengthscale: 0.471 noise: 1.310
Epoch  70/150 - Loss: 1.737 lengthscale: 0.448 noise: 1.172
Epoch  80/150 - Loss: 1.692 lengthscale: 0.427 noise: 1.038
Epoch  90/150 - Loss: 1.645 lengthscale: 0.407 noise: 0.908
Epoch 100/150 - Loss: 1.595 lengthscale: 0.389 noise: 0.785
Epoch 110/150 - Loss: 1.542 lengthscale: 0.372 noise: 0.671
Epoch 120/150 - Loss: 1.487 lengthscale: 0.355 noise: 0.566
Epoch 130/150 - Loss: 1.429 lengthscale: 0.341 noise: 0.471
Epoch 140/150 - Loss: 1.370 lengthscale: 0.328 noise: 0.389
Epoch 150/150 - Loss: 1.311 lengthscale: 0.317 noise: 0.318
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Compute-posterior-over-test-points-and-plot-fit">Compute posterior over test points and plot fit<a class="anchor-link" href="#Compute-posterior-over-test-points-and-plot-fit">¶</a></h4><p>We plot the posterior mean and the 2 standard deviations from the mean.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># set model (and likelihood)</span>
<span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="c1"># Initialize plot</span>
<span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="c1"># test model on 101 regular spaced points on the interval [0, 1]</span>
<span class="n">test_X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<span class="c1"># no need for gradients</span>
<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="c1"># compute posterior</span>
    <span class="n">posterior</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">posterior</span><span class="p">(</span><span class="n">test_X</span><span class="p">)</span>
    <span class="c1"># Get upper and lower confidence bounds (2 standard deviations from the mean)</span>
    <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="n">posterior</span><span class="o">.</span><span class="n">mvn</span><span class="o">.</span><span class="n">confidence_region</span><span class="p">()</span>
    <span class="c1"># Plot training points as black stars</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">train_X</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="n">train_Y</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="s1">'k*'</span><span class="p">)</span>
    <span class="c1"># Plot posterior means as blue line</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_X</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="n">posterior</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="s1">'b'</span><span class="p">)</span>
    <span class="c1"># Shade between the lower and upper confidence bounds</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">test_X</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="n">lower</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="n">upper</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">'Observed Data'</span><span class="p">,</span> <span class="s1">'Mean'</span><span class="p">,</span> <span class="s1">'Confidence'</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea">
<img src="data:image/png;base64,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
4aQjqAF4AAAAAElFTkSuQmCC
"/>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Interfacing-with-Ax">Interfacing with Ax<a class="anchor-link" href="#Interfacing-with-Ax">¶</a></h3><p>It is simple to package up a custom optimizer loop like the one above and use it within Ax. As described in the <a href="./custom_botorch_model_in_ax">Using BoTorch with Ax tutorial</a>, this requires defining a custom <code>model_constructor</code> callable that can then be passed to the <code>get_botorch</code> factory function.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">_get_and_fit_model</span><span class="p">(</span><span class="n">Xs</span><span class="p">,</span> <span class="n">Ys</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    
    <span class="n">train_X</span><span class="p">,</span> <span class="n">train_Y</span> <span class="o">=</span> <span class="n">Xs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Ys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">SingleTaskGP</span><span class="p">(</span><span class="n">train_X</span><span class="o">=</span><span class="n">train_X</span><span class="p">,</span> <span class="n">train_Y</span><span class="o">=</span><span class="n">train_Y</span><span class="p">)</span>
    <span class="n">mll</span> <span class="o">=</span> <span class="n">ExactMarginalLogLikelihood</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">likelihood</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">train_X</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
    
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">SGD</span><span class="p">([{</span><span class="s1">'params'</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">()}],</span> <span class="n">lr</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"lr"</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"epochs"</span><span class="p">)):</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">train_X</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="o">-</span><span class="n">mll</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">train_targets</span><span class="p">)</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">model</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div></div><div class="tutorialButtonWrapper buttonWrapper"><a class="tutorialButton button" download="" href="/files/fit_model_with_torch_optimizer.ipynb" target="_blank"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="file-download" class="svg-inline--fa fa-file-download fa-w-12" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm76.45 211.36l-96.42 95.7c-6.65 6.61-17.39 6.61-24.04 0l-96.42-95.7C73.42 337.29 80.54 320 94.82 320H160v-80c0-8.84 7.16-16 16-16h32c8.84 0 16 7.16 16 16v80h65.18c14.28 0 21.4 17.29 11.27 27.36zM377 105L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9z"></path></svg>Download Tutorial Jupyter Notebook</a></div><div class="tutorialButtonWrapper buttonWrapper"><a class="tutorialButton button" download="" href="/files/fit_model_with_torch_optimizer.py" target="_blank"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="file-download" class="svg-inline--fa fa-file-download fa-w-12" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm76.45 211.36l-96.42 95.7c-6.65 6.61-17.39 6.61-24.04 0l-96.42-95.7C73.42 337.29 80.54 320 94.82 320H160v-80c0-8.84 7.16-16 16-16h32c8.84 0 16 7.16 16 16v80h65.18c14.28 0 21.4 17.29 11.27 27.36zM377 105L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9z"></path></svg>Download Tutorial Source Code</a></div></div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/botorch.png" alt="BoTorch" width="66" height="58"/></a><div class="footerSection"><h5>Docs</h5><a href="/docs/introduction">Introduction</a><a href="/docs/getting_started">Getting Started</a><a href="/tutorials/">Tutorials</a><a href="/api/">API Reference</a><a href="https://arxiv.org/abs/1910.06403">Paper</a></div><div class="footerSection"><h5>Legal</h5><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noreferrer noopener">Privacy</a><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noreferrer noopener">Terms</a></div><div class="footerSection"><h5>Social</h5><div class="social"><a class="github-button" href="https://github.com/pytorch/botorch" data-count-href="https://github.com/pytorch/botorch/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star BoTorch on GitHub">botorch</a></div></div></section><a href="https://opensource.facebook.com/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright"> Copyright © 2022 Meta Platforms Inc.</section><script>
            (function() {
              var BAD_BASE = '/botorch/';
              if (window.location.origin !== 'https://botorch.org') {
                var pathname = window.location.pathname;
                var newPathname = pathname.slice(pathname.indexOf(BAD_BASE) === 0 ? BAD_BASE.length : 1);
                var newLocation = 'https://botorch.org/' + newPathname;
                console.log('redirecting to ' + newLocation);
                window.location.href = newLocation;
              }
            })();
          </script></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '207c27d819f967749142d8611de7cb19',
                indexName: 'botorch',
                inputSelector: '#search_input_react'
              });
            </script></body></html>