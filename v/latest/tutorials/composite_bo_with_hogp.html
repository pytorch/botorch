<!DOCTYPE html><html lang=""><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>BoTorch · Bayesian Optimization in PyTorch</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="Bayesian Optimization in PyTorch"/><meta property="og:title" content="BoTorch · Bayesian Optimization in PyTorch"/><meta property="og:type" content="website"/><meta property="og:url" content="https://botorch.org/v/latest/"/><meta property="og:description" content="Bayesian Optimization in PyTorch"/><meta property="og:image" content="https://botorch.org/v/latest/img/botorch.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://botorch.org/v/latest/img/botorch.png"/><link rel="shortcut icon" href="/v/latest/img/botorch.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-139570076-2', 'auto');
              ga('send', 'pageview');
            </script><link rel="stylesheet" href="/v/latest/css/code_block_buttons.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="/v/latest/js/code_block_buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/v/latest/js/mathjax.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/v/latest/js/scrollSpy.js"></script><link rel="stylesheet" href="/v/latest/css/main.css"/><script src="/v/latest/js/codetabs.js"></script></head><body><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/v/latest/"><img class="logo" src="/v/latest/img/botorch_logo_lockup_white.png" alt="BoTorch"/><h2 class="headerTitleWithLogo">BoTorch</h2></a><a href="/v/latest/versions"><h3>latest</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/v/latest/docs/introduction" target="_self">Docs</a></li><li class=""><a href="/v/latest/tutorials/" target="_self">Tutorials</a></li><li class=""><a href="/v/latest/api/" target="_self">API Reference</a></li><li class=""><a href="/v/latest/docs/papers" target="_self">Papers</a></li><li class=""><a href="https://github.com/pytorch/botorch" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span></span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Tutorials</h3><ul class=""><li class="navListItem"><a class="navItem" href="/v/latest/tutorials/">Overview</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Using BoTorch with Ax</h3><ul class=""><li class="navListItem"><a class="navItem" href="/v/latest/tutorials/custom_botorch_model_in_ax">Using a custom BoTorch model</a></li><li class="navListItem"><a class="navItem" href="/v/latest/tutorials/custom_acquisition">Writing a custom acquisition function</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Full Optimization Loops</h3><ul class=""><li class="navListItem"><a class="navItem" href="/v/latest/tutorials/closed_loop_botorch_only">q-Noisy Constrained EI</a></li><li class="navListItem"><a class="navItem" href="/v/latest/tutorials/preference_bo">Bayesian optimization with pairwise comparison data</a></li><li class="navListItem"><a class="navItem" href="/v/latest/tutorials/bope">Bayesian optimization with preference exploration</a></li><li class="navListItem"><a class="navItem" href="/v/latest/tutorials/turbo_1">Trust Region Bayesian Optimization (TuRBO)</a></li><li class="navListItem"><a class="navItem" href="/v/latest/tutorials/saasbo">High-dimensional Bayesian optimization with SAASBO</a></li><li class="navListItem"><a class="navItem" href="/v/latest/tutorials/bo_with_warped_gp">Bayesian optimization with input warping</a></li><li class="navListItem"><a class="navItem" href="/v/latest/tutorials/thompson_sampling">Bayesian optimization with large-scale Thompson sampling</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Multi-Objective Bayesian Optimization</h3><ul class=""><li class="navListItem"><a class="navItem" href="/v/latest/tutorials/multi_objective_bo">Multi-objective optimization with qEHVI, qNEHVI, and qNParEGO</a></li><li class="navListItem"><a class="navItem" href="/v/latest/tutorials/constrained_multi_objective_bo">Constrained multi-objective optimization with qNEHVI and qParEGO</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Bite-Sized Tutorials</h3><ul class=""><li class="navListItem"><a class="navItem" href="/v/latest/tutorials/fit_model_with_torch_optimizer">Fitting a model using torch.optim</a></li><li class="navListItem"><a class="navItem" href="/v/latest/tutorials/compare_mc_analytic_acquisition">Comparing analytic and MC Expected Improvement</a></li><li class="navListItem"><a class="navItem" href="/v/latest/tutorials/optimize_with_cmaes">Acquisition function optimization with CMA-ES</a></li><li class="navListItem"><a class="navItem" href="/v/latest/tutorials/optimize_stochastic">Acquisition function optimization with torch.optim</a></li><li class="navListItem"><a class="navItem" href="/v/latest/tutorials/batch_mode_cross_validation">Using batch evaluation for fast cross-validation</a></li><li class="navListItem"><a class="navItem" href="/v/latest/tutorials/one_shot_kg">The one-shot Knowledge Gradient acquisition function</a></li><li class="navListItem"><a class="navItem" href="/v/latest/tutorials/max_value_entropy">The max-value entropy search acquisition function</a></li><li class="navListItem"><a class="navItem" href="/v/latest/tutorials/GIBBON_for_efficient_batch_entropy_search">The GIBBON acquisition function for efficient batch entropy search</a></li><li class="navListItem"><a class="navItem" href="/v/latest/tutorials/risk_averse_bo_with_environmental_variables">Risk averse Bayesian optimization with environmental variables</a></li><li class="navListItem"><a class="navItem" href="/v/latest/tutorials/risk_averse_bo_with_input_perturbations">Risk averse Bayesian optimization with input perturbations</a></li><li class="navListItem"><a class="navItem" href="/v/latest/tutorials/constraint_active_search">Constraint Active Search for Multiobjective Experimental Design</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Advanced Usage</h3><ul class=""><li class="navListItem"><a class="navItem" href="/v/latest/tutorials/meta_learning_with_rgpe">Meta-learning with RGPE</a></li><li class="navListItem"><a class="navItem" href="/v/latest/tutorials/vae_mnist">High-dimensional optimization with VAEs</a></li><li class="navListItem"><a class="navItem" href="/v/latest/tutorials/multi_fidelity_bo">Multi-fidelity Bayesian optimization using KG</a></li><li class="navListItem"><a class="navItem" href="/v/latest/tutorials/discrete_multi_fidelity_bo">Multi-fidelity Bayesian optimization with discrete fidelities using KG</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/v/latest/tutorials/composite_bo_with_hogp">Composite Bayesian optimization with the High Order Gaussian Process</a></li><li class="navListItem"><a class="navItem" href="/v/latest/tutorials/composite_mtbo">Composite Bayesian Optimization with Multi-Task Gaussian Processes</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="tutorialBody">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<div class="notebook">
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Composite-Bayesian-Optimization-with-the-High-Order-Gaussian-Process">Composite Bayesian Optimization with the High Order Gaussian Process<a class="anchor-link" href="#Composite-Bayesian-Optimization-with-the-High-Order-Gaussian-Process">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this tutorial, we're going to explore composite Bayesian optimization <a href="https://proceedings.mlr.press/v97/astudillo19a.html">Astudillo &amp; Frazier, ICML, '19</a> with the High Order Gaussian Process (HOGP) model of <a href="http://proceedings.mlr.press/v89/zhe19a.html">Zhe et al, AISTATS, '19</a>. The setup for composite Bayesian optimization is that we have an unknown (black box) function mapping input parameters to several outputs, and a second, known function describing the quality of the functional output. We wish to find input parameters that maximize the output metric function. We wish to find input parameters that maximize the output metric function in a black-box manner.</p>
<p>Specifically, this can be described as $\max_{x \in \mathcal{X}} g(f(x)),$ where $f$ is unknown and $g$ is known. As in traditional Bayesian optimization, we are going to construct a Gaussian process surrogate model over the expensive to evaluate function $f(.),$ and will use a HOGP to model this function.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="HOGP-model-description">HOGP model description<a class="anchor-link" href="#HOGP-model-description">¶</a></h3><p>The <a href="https://proceedings.mlr.press/v89/zhe19a.html">High Order Gaussian Process (HOGP) model</a> is a Gaussian process model designed specifically to operate over tensors or multi-dimensional arrays and exploits structure in the tensor to be able to operate efficiently. Specifically, the HOGP takes as inputs $y \in \mathbb{R}^{N \times d_2 \times \cdots \times d_M}$ and assumes that $\text{vec}(y) \sim \mathcal{N}(0, \otimes_{i=1}^M K_i + \sigma^2 I),$ where $K_1 = K_{XX}.$ Each dimension of the tensor has its own kernel function, $K_i,$ as well as a set of $d_i$ latent parameters that can be optimized over.</p>
<p>Recently, <a href="https://arxiv.org/abs/2106.12997">Maddox et al, '21</a> proposed a method for computing posterior samples from the HOGP by exploiting structure in the posterior distribution, thereby enabling its usage in BO settings. While they show that this approach allows to use composite BO on problems with tens or thousands of outputs, for scalability we consider a much smaller example here (that does not require GPU acceleration).</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">import</span> <span class="nn">gpytorch.settings</span> <span class="k">as</span> <span class="nn">gpt_settings</span>

<span class="kn">from</span> <span class="nn">botorch.acquisition</span> <span class="kn">import</span> <span class="n">qSimpleRegret</span><span class="p">,</span> <span class="n">qExpectedImprovement</span>
<span class="kn">from</span> <span class="nn">botorch.acquisition.objective</span> <span class="kn">import</span> <span class="n">GenericMCObjective</span>
<span class="kn">from</span> <span class="nn">botorch.models</span> <span class="kn">import</span> <span class="n">HigherOrderGP</span><span class="p">,</span> <span class="n">SingleTaskGP</span>
<span class="kn">from</span> <span class="nn">botorch.models.higher_order_gp</span> <span class="kn">import</span> <span class="n">FlattenedStandardize</span>
<span class="kn">from</span> <span class="nn">botorch.models.transforms</span> <span class="kn">import</span> <span class="n">Normalize</span><span class="p">,</span> <span class="n">Standardize</span>
<span class="kn">from</span> <span class="nn">botorch</span> <span class="kn">import</span> <span class="n">fit_gpytorch_model</span>
<span class="kn">from</span> <span class="nn">botorch.optim</span> <span class="kn">import</span> <span class="n">optimize_acqf</span>
<span class="kn">from</span> <span class="nn">botorch.sampling</span> <span class="kn">import</span> <span class="n">IIDNormalSampler</span>
<span class="kn">from</span> <span class="nn">botorch.utils.sampling</span> <span class="kn">import</span> <span class="n">draw_sobol_samples</span>

<span class="kn">from</span> <span class="nn">gpytorch.mlls</span> <span class="kn">import</span> <span class="n">ExactMarginalLogLikelihood</span>

<span class="n">SMOKE_TEST</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"SMOKE_TEST"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">botorch.optim.fit</span> <span class="kn">import</span> <span class="n">fit_gpytorch_torch</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Set-Device-and-dtype">Set Device and dtype<a class="anchor-link" href="#Set-Device-and-dtype">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">"cpu"</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">"cuda:0"</span><span class="p">)</span>
<span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">float</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Using "</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Using  cuda:0
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">models_used</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">"rnd"</span><span class="p">,</span>
    <span class="s2">"ei"</span><span class="p">,</span>
    <span class="s2">"ei_hogp_cf"</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Problem-Description">Problem Description<a class="anchor-link" href="#Problem-Description">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We use a simple test problem describing the concentration of pollutants after a chemical spill from <a href="https://proceedings.mlr.press/v97/astudillo19a.html">Astudillo &amp; Frazier, ICML, '19</a> defined over a $3 \times 4$ grid of values $s,t$ and we wish to optimize the parameters w.r.t. their true values, to estimate the true value of parameters, $x = [M, D, L, \tau].$ The function is given by 
$$ f(s,t | M, D, L, \tau) := \frac{M}{\sqrt{4 \pi D t}}  \exp\{-\frac{s^2}{4Dt}\} + \frac{1_{t &gt; \tau} M}{\sqrt{4 \pi D(t - \tau)}} \exp\{- \frac{(s - L)^2}{4 D (t - \tau)}\}, $$
with the cheap to evaluate, differentiable function given by $g(y):= \sum_{(s,t) \in S \times T} \left(c(s, t|x_{\text{true}}) - y\right)^2.$ As the objective function itself is going to be implemented in Pytorch, we will be able to differentiate through it, enabling the usage of gradient-based optimization to optimize the objectives with respect to the inputs.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">env_cfun</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">tau</span><span class="p">):</span>
    <span class="n">c1</span> <span class="o">=</span> <span class="n">M</span> <span class="o">/</span> <span class="n">torch</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">D</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">exp1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">s</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">/</span> <span class="n">D</span> <span class="o">/</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">term1</span> <span class="o">=</span> <span class="n">c1</span> <span class="o">*</span> <span class="n">exp1</span>
    <span class="n">c2</span> <span class="o">=</span> <span class="n">M</span> <span class="o">/</span> <span class="n">torch</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">D</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">tau</span><span class="p">))</span>
    <span class="n">exp2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">s</span> <span class="o">-</span> <span class="n">L</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">/</span> <span class="n">D</span> <span class="o">/</span> <span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">tau</span><span class="p">))</span>
    <span class="n">term2</span> <span class="o">=</span> <span class="n">c2</span> <span class="o">*</span> <span class="n">exp2</span>
    <span class="n">term2</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">term2</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">return</span> <span class="n">term1</span> <span class="o">+</span> <span class="n">term2</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Helper-Functions">Helper Functions<a class="anchor-link" href="#Helper-Functions">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>These are helper functions for us to maximize the acquisition function and to get random points.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">gen_rand_points</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">):</span>
    <span class="n">points_nlzd</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_samples</span><span class="p">,</span> <span class="n">bounds</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">points_nlzd</span>
    

<span class="k">def</span> <span class="nf">optimize_ei</span><span class="p">(</span><span class="n">qEI</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">gpt_settings</span><span class="o">.</span><span class="n">fast_computations</span><span class="p">(</span><span class="n">covar_root_decomposition</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">cands_nlzd</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">optimize_acqf</span><span class="p">(</span>
                <span class="n">qEI</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">,</span> 
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">cands_nlzd</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Below is a wrapped function to help us define bounds on the parameter space, we can also vary the size of the grid if we'd like to.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">prepare_data</span><span class="p">(</span><span class="n">s_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">t_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"---- Running the environmental problem with "</span><span class="p">,</span> <span class="n">s_size</span><span class="p">,</span> <span class="n">t_size</span><span class="p">,</span> <span class="s2">" ----"</span><span class="p">)</span>
    <span class="c1"># X = [M, D, L, tau]</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span>
        <span class="p">[[</span><span class="mf">7.0</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">30.010</span><span class="p">],</span> <span class="p">[</span><span class="mf">13.0</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mf">3.00</span><span class="p">,</span> <span class="mf">30.295</span><span class="p">]],</span>
        <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
        <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">M0</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
    <span class="n">D0</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.07</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
    <span class="n">L0</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mf">1.505</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
    <span class="n">tau0</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mf">30.1525</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

    <span class="c1"># we can vectorize everything, no need for loops</span>
    <span class="k">if</span> <span class="n">s_size</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">S</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">S</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="n">s_size</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">t_size</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">T</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">15.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">45.0</span><span class="p">,</span> <span class="mf">60.0</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">T</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">15.0</span><span class="p">,</span> <span class="mf">60.0</span><span class="p">,</span> <span class="n">t_size</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

    <span class="n">Sgrid</span><span class="p">,</span> <span class="n">Tgrid</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>

    <span class="c1"># X = [M, D, L, tau]</span>
    <span class="k">def</span> <span class="nf">c_batched</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">env_cfun</span><span class="p">(</span><span class="n">Sgrid</span><span class="p">,</span> <span class="n">Tgrid</span><span class="p">,</span> <span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">X</span><span class="p">])</span>

    <span class="n">c_true</span> <span class="o">=</span> <span class="n">env_cfun</span><span class="p">(</span><span class="n">Sgrid</span><span class="p">,</span> <span class="n">Tgrid</span><span class="p">,</span> <span class="n">M0</span><span class="p">,</span> <span class="n">D0</span><span class="p">,</span> <span class="n">L0</span><span class="p">,</span> <span class="n">tau0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">neq_sum_quared_diff</span><span class="p">(</span><span class="n">samples</span><span class="p">):</span>
        <span class="c1"># unsqueeze</span>
        <span class="k">if</span> <span class="n">samples</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="n">s_size</span> <span class="o">*</span> <span class="n">t_size</span><span class="p">):</span>
            <span class="n">samples</span> <span class="o">=</span> <span class="n">samples</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
                <span class="o">*</span><span class="n">samples</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">s_size</span><span class="p">,</span> <span class="n">t_size</span>
            <span class="p">)</span>

        <span class="n">sq_diffs</span> <span class="o">=</span> <span class="p">(</span><span class="n">samples</span> <span class="o">-</span> <span class="n">c_true</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sq_diffs</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>

    <span class="n">objective</span> <span class="o">=</span> <span class="n">GenericMCObjective</span><span class="p">(</span><span class="n">neq_sum_quared_diff</span><span class="p">)</span>
    <span class="n">num_samples</span> <span class="o">=</span> <span class="mi">32</span>

    <span class="k">return</span> <span class="n">c_batched</span><span class="p">,</span> <span class="n">objective</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">num_samples</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the above, we construct a <code>GenericMCObjective</code> instance to codify the objective function (which is minimizing the MSE of the output tensors and the outputs corresponding to the "true" parameter values). Note that the objective function is encoded in PyTorch and is differentiable (although it technically doesn't have to be). Ultimately, we backpropagate through the objective with respect to the input parameters (and through the HOGP as well).</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="BO-Loop">BO Loop<a class="anchor-link" href="#BO-Loop">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we run the BO loop over three trials for $15$ batches each. This loop might take a while.</p>
<p>We will be comparing to both random selection and batch expected improvment on the aggregated metric.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">n_init</span> <span class="o">=</span> <span class="mi">30</span>

<span class="k">if</span> <span class="n">SMOKE_TEST</span><span class="p">:</span>
    <span class="n">n_batches</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">n_trials</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">n_batches</span> <span class="o">=</span> <span class="mi">15</span>
    <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">n_trials</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As a word of caution, we've found that when fitting the HOGP model, using first-order optimizers (e.g. Adam) as is used in <code>fit_gpytorch_torch</code> tends to outperform second-order optimizers such as L-BFGS-B due to the large number of free parameters in the HOGP. L-BFGS-B tends to overfit in practice here.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">all_objective_vals</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">with</span> <span class="n">gpt_settings</span><span class="o">.</span><span class="n">cholesky_jitter</span><span class="p">(</span><span class="mf">1e-4</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">trial</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_trials</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"Beginning with trial: "</span><span class="p">,</span> <span class="n">trial</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">c_batched</span><span class="p">,</span> <span class="n">objective</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">num_samples</span> <span class="o">=</span> <span class="n">prepare_data</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

        <span class="n">train_X_init</span> <span class="o">=</span> <span class="n">gen_rand_points</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="n">n_init</span><span class="p">)</span>
        <span class="n">train_Y_init</span> <span class="o">=</span> <span class="n">c_batched</span><span class="p">(</span><span class="n">train_X_init</span><span class="p">)</span>

        <span class="c1"># these will keep track of the points explored</span>
        <span class="n">train_X</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">train_X_init</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">models_used</span><span class="p">}</span>
        <span class="n">train_Y</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">train_Y_init</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">train_X</span><span class="p">}</span>

        <span class="c1"># run the BO loop</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_batches</span><span class="p">):</span>
            <span class="n">tic</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

            <span class="c1"># get best observations, log status</span>
            <span class="n">best_f</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">objective</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">train_Y</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">"It </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">:</span><span class="s2">&gt;2</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">n_batches</span><span class="si">}</span><span class="s2">, best obs.: "</span>
                <span class="s2">", "</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">"</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">best_f</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
            <span class="p">)</span>

            <span class="c1"># generate random candidates</span>
            <span class="n">cands</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">cands</span><span class="p">[</span><span class="s2">"rnd"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gen_rand_points</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">)</span>

            <span class="n">optimize_acqf_kwargs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">"q"</span><span class="p">:</span> <span class="n">batch_size</span><span class="p">,</span>
                <span class="s2">"num_restarts"</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
                <span class="s2">"raw_samples"</span><span class="p">:</span> <span class="mi">512</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="n">sampler</span> <span class="o">=</span> <span class="n">IIDNormalSampler</span><span class="p">(</span><span class="n">num_samples</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>

            <span class="n">train_Y_ei</span> <span class="o">=</span> <span class="n">objective</span><span class="p">(</span><span class="n">train_Y</span><span class="p">[</span><span class="s2">"ei"</span><span class="p">])</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">model_ei</span> <span class="o">=</span> <span class="n">SingleTaskGP</span><span class="p">(</span>
                <span class="n">train_X</span><span class="p">[</span><span class="s2">"ei"</span><span class="p">],</span>
                <span class="n">train_Y_ei</span><span class="p">,</span>
                <span class="n">input_transform</span><span class="o">=</span><span class="n">Normalize</span><span class="p">(</span><span class="n">train_X</span><span class="p">[</span><span class="s2">"ei"</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
                <span class="n">outcome_transform</span><span class="o">=</span><span class="n">Standardize</span><span class="p">(</span><span class="n">train_Y_ei</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
            <span class="p">)</span>

            <span class="n">mll</span> <span class="o">=</span> <span class="n">ExactMarginalLogLikelihood</span><span class="p">(</span><span class="n">model_ei</span><span class="o">.</span><span class="n">likelihood</span><span class="p">,</span> <span class="n">model_ei</span><span class="p">)</span>
            <span class="n">fit_gpytorch_torch</span><span class="p">(</span><span class="n">mll</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">"lr"</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span> <span class="s2">"maxiter"</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span> <span class="s2">"disp"</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>

            <span class="c1"># generate qEI candidate (single output modeling)</span>
            <span class="n">qEI</span> <span class="o">=</span> <span class="n">qExpectedImprovement</span><span class="p">(</span><span class="n">model_ei</span><span class="p">,</span> <span class="n">best_f</span><span class="o">=</span><span class="n">best_f</span><span class="p">[</span><span class="s2">"ei"</span><span class="p">],</span> <span class="n">sampler</span><span class="o">=</span><span class="n">sampler</span><span class="p">)</span>
            <span class="n">cands</span><span class="p">[</span><span class="s2">"ei"</span><span class="p">]</span> <span class="o">=</span> <span class="n">optimize_ei</span><span class="p">(</span><span class="n">qEI</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="o">**</span><span class="n">optimize_acqf_kwargs</span><span class="p">)</span>

            <span class="n">model_ei_hogp_cf</span> <span class="o">=</span> <span class="n">HigherOrderGP</span><span class="p">(</span>
                <span class="n">train_X</span><span class="p">[</span><span class="s2">"ei_hogp_cf"</span><span class="p">],</span>
                <span class="n">train_Y</span><span class="p">[</span><span class="s2">"ei_hogp_cf"</span><span class="p">],</span>
                <span class="n">outcome_transform</span><span class="o">=</span><span class="n">FlattenedStandardize</span><span class="p">(</span><span class="n">train_Y</span><span class="p">[</span><span class="s2">"ei_hogp_cf"</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]),</span>
                <span class="n">input_transform</span><span class="o">=</span><span class="n">Normalize</span><span class="p">(</span><span class="n">train_X</span><span class="p">[</span><span class="s2">"ei_hogp_cf"</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
                <span class="n">latent_init</span><span class="o">=</span><span class="s2">"gp"</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">mll</span> <span class="o">=</span> <span class="n">ExactMarginalLogLikelihood</span><span class="p">(</span><span class="n">model_ei_hogp_cf</span><span class="o">.</span><span class="n">likelihood</span><span class="p">,</span> <span class="n">model_ei_hogp_cf</span><span class="p">)</span>
            <span class="n">fit_gpytorch_torch</span><span class="p">(</span><span class="n">mll</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">"lr"</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span> <span class="s2">"maxiter"</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span> <span class="s2">"disp"</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>

            <span class="c1"># generate qEI candidate (multi-output modeling)</span>
            <span class="n">qEI_hogp_cf</span> <span class="o">=</span> <span class="n">qExpectedImprovement</span><span class="p">(</span>
                <span class="n">model_ei_hogp_cf</span><span class="p">,</span>
                <span class="n">best_f</span><span class="o">=</span><span class="n">best_f</span><span class="p">[</span><span class="s2">"ei_hogp_cf"</span><span class="p">],</span>
                <span class="n">sampler</span><span class="o">=</span><span class="n">sampler</span><span class="p">,</span>
                <span class="n">objective</span><span class="o">=</span><span class="n">objective</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">cands</span><span class="p">[</span><span class="s2">"ei_hogp_cf"</span><span class="p">]</span> <span class="o">=</span> <span class="n">optimize_ei</span><span class="p">(</span><span class="n">qEI_hogp_cf</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="o">**</span><span class="n">optimize_acqf_kwargs</span><span class="p">)</span>

            <span class="c1"># make observations and update data</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">Xold</span> <span class="ow">in</span> <span class="n">train_X</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">Xnew</span> <span class="o">=</span> <span class="n">cands</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">Xnew</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">train_X</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">Xold</span><span class="p">,</span> <span class="n">Xnew</span><span class="p">])</span>
                    <span class="n">train_Y</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">train_Y</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">c_batched</span><span class="p">(</span><span class="n">Xnew</span><span class="p">)])</span>

            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Wall time: </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">tic</span><span class="si">:</span><span class="s2">1f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

        <span class="n">objective_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">objective</span><span class="p">(</span><span class="n">train_Y</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">train_Y</span><span class="p">}</span>
        <span class="n">all_objective_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">objective_dict</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"Finished with trial: "</span><span class="p">,</span> <span class="n">trial</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Beginning with trial:  1
---- Running the environmental problem with  3 4  ----
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>I0712 100259.916 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.277It  1/15, best obs.: , ei: -0.277It  1/15, best obs.: , ei_hogp_cf: -0.277
I0712 100313.875 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 13.959815
I0712 100313.876 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.277It  2/15, best obs.: , ei: -0.277It  2/15, best obs.: , ei_hogp_cf: -0.277
I0712 100331.374 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 17.497971
I0712 100331.375 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.277It  3/15, best obs.: , ei: -0.277It  3/15, best obs.: , ei_hogp_cf: -0.277
I0712 100351.131 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 19.756105
I0712 100351.132 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.277It  4/15, best obs.: , ei: -0.277It  4/15, best obs.: , ei_hogp_cf: -0.277
I0712 100423.226 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 32.094512
I0712 100423.228 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.277It  5/15, best obs.: , ei: -0.277It  5/15, best obs.: , ei_hogp_cf: -0.277
I0712 100454.340 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 31.112883
I0712 100454.342 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.277It  6/15, best obs.: , ei: -0.277It  6/15, best obs.: , ei_hogp_cf: -0.219
I0712 100554.118 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 59.776674
I0712 100554.119 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.277It  7/15, best obs.: , ei: -0.277It  7/15, best obs.: , ei_hogp_cf: -0.137
I0712 100649.414 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 55.294851
I0712 100649.415 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.277It  8/15, best obs.: , ei: -0.277It  8/15, best obs.: , ei_hogp_cf: -0.076
/mnt/xarfuse/uid-22017/907c0fbc-seed-nspid4026533651_cgpid35640602-ns-4026533648/gpytorch/utils/cholesky.py:44: NumericalWarning:

A not p.d., added jitter of 1.0e-04 to the diagonal

I0712 100659.421 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 10.006811
I0712 100659.423 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.277It  9/15, best obs.: , ei: -0.277It  9/15, best obs.: , ei_hogp_cf: -0.076
I0712 100713.541 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 14.118601
I0712 100713.543 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.277It 10/15, best obs.: , ei: -0.277It 10/15, best obs.: , ei_hogp_cf: -0.076
I0712 100725.215 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 11.672525
I0712 100725.216 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.277It 11/15, best obs.: , ei: -0.277It 11/15, best obs.: , ei_hogp_cf: -0.076
I0712 100733.256 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 8.040162
I0712 100733.257 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.277It 12/15, best obs.: , ei: -0.277It 12/15, best obs.: , ei_hogp_cf: -0.076
I0712 100746.931 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 13.674355
I0712 100746.933 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.277It 13/15, best obs.: , ei: -0.277It 13/15, best obs.: , ei_hogp_cf: -0.076
I0712 100835.895 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 48.962623
I0712 100835.897 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.277It 14/15, best obs.: , ei: -0.212It 14/15, best obs.: , ei_hogp_cf: -0.035
I0712 100847.778 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 11.881666
I0712 100847.780 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.277It 15/15, best obs.: , ei: -0.212It 15/15, best obs.: , ei_hogp_cf: -0.035
I0712 100927.273 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 39.493477
I0712 100927.289 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.423It  1/15, best obs.: , ei: -0.423It  1/15, best obs.: , ei_hogp_cf: -0.423
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Finished with trial:  1
Beginning with trial:  2
---- Running the environmental problem with  3 4  ----
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>I0712 100953.469 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 26.180312
I0712 100953.471 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.423It  2/15, best obs.: , ei: -0.423It  2/15, best obs.: , ei_hogp_cf: -0.108
I0712 101006.910 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 13.439897
I0712 101006.912 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.423It  3/15, best obs.: , ei: -0.131It  3/15, best obs.: , ei_hogp_cf: -0.108
I0712 101021.213 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 14.300933
I0712 101021.215 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.423It  4/15, best obs.: , ei: -0.131It  4/15, best obs.: , ei_hogp_cf: -0.108
I0712 101029.243 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 8.029261
I0712 101029.245 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.423It  5/15, best obs.: , ei: -0.131It  5/15, best obs.: , ei_hogp_cf: -0.108
I0712 101106.178 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 36.933169
I0712 101106.179 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.278It  6/15, best obs.: , ei: -0.131It  6/15, best obs.: , ei_hogp_cf: -0.043
I0712 101142.619 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 36.440421
I0712 101142.621 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.278It  7/15, best obs.: , ei: -0.131It  7/15, best obs.: , ei_hogp_cf: -0.021
I0712 101152.412 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 9.791319
I0712 101152.413 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.278It  8/15, best obs.: , ei: -0.131It  8/15, best obs.: , ei_hogp_cf: -0.021
I0712 101221.768 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 29.355340
I0712 101221.770 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.278It  9/15, best obs.: , ei: -0.131It  9/15, best obs.: , ei_hogp_cf: -0.021
I0712 101232.866 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 11.096618
I0712 101232.867 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.278It 10/15, best obs.: , ei: -0.131It 10/15, best obs.: , ei_hogp_cf: -0.021
I0712 101307.960 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 35.093111
I0712 101307.962 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.278It 11/15, best obs.: , ei: -0.131It 11/15, best obs.: , ei_hogp_cf: -0.021
I0712 101317.455 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 9.493767
I0712 101317.457 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.278It 12/15, best obs.: , ei: -0.131It 12/15, best obs.: , ei_hogp_cf: -0.021
I0712 101401.017 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 43.560580
I0712 101401.018 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.209It 13/15, best obs.: , ei: -0.131It 13/15, best obs.: , ei_hogp_cf: -0.021
I0712 101411.866 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 10.848468
I0712 101411.868 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.209It 14/15, best obs.: , ei: -0.131It 14/15, best obs.: , ei_hogp_cf: -0.021
I0712 101428.308 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 16.440600
I0712 101428.310 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.209It 15/15, best obs.: , ei: -0.131It 15/15, best obs.: , ei_hogp_cf: -0.021
I0712 101516.034 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 47.724485
I0712 101516.051 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.419It  1/15, best obs.: , ei: -0.419It  1/15, best obs.: , ei_hogp_cf: -0.419
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Finished with trial:  2
Beginning with trial:  3
---- Running the environmental problem with  3 4  ----
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>I0712 101538.563 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 22.512460
I0712 101538.564 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.419It  2/15, best obs.: , ei: -0.419It  2/15, best obs.: , ei_hogp_cf: -0.419
I0712 101557.352 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 18.788451
I0712 101557.354 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.373It  3/15, best obs.: , ei: -0.419It  3/15, best obs.: , ei_hogp_cf: -0.409
I0712 101624.634 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 27.281004
I0712 101624.636 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.373It  4/15, best obs.: , ei: -0.419It  4/15, best obs.: , ei_hogp_cf: -0.238
I0712 101648.071 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 23.435322
I0712 101648.072 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.373It  5/15, best obs.: , ei: -0.419It  5/15, best obs.: , ei_hogp_cf: -0.238
I0712 101717.918 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 29.846168
I0712 101717.920 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.373It  6/15, best obs.: , ei: -0.419It  6/15, best obs.: , ei_hogp_cf: -0.235
I0712 101737.518 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 19.599094
I0712 101737.520 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.373It  7/15, best obs.: , ei: -0.419It  7/15, best obs.: , ei_hogp_cf: -0.235
I0712 101818.189 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 40.669840
I0712 101818.191 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.316It  8/15, best obs.: , ei: -0.419It  8/15, best obs.: , ei_hogp_cf: -0.053
I0712 101831.639 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 13.448530
I0712 101831.640 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.316It  9/15, best obs.: , ei: -0.419It  9/15, best obs.: , ei_hogp_cf: -0.053
I0712 101908.641 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 37.001188
I0712 101908.643 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.316It 10/15, best obs.: , ei: -0.419It 10/15, best obs.: , ei_hogp_cf: -0.020
I0712 101935.712 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 27.069663
I0712 101935.713 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.316It 11/15, best obs.: , ei: -0.419It 11/15, best obs.: , ei_hogp_cf: -0.020
/mnt/xarfuse/uid-22017/907c0fbc-seed-nspid4026533651_cgpid35640602-ns-4026533648/gpytorch/utils/cholesky.py:44: NumericalWarning:

A not p.d., added jitter of 1.0e-04 to the diagonal

I0712 102016.146 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 40.432912
I0712 102016.147 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.316It 12/15, best obs.: , ei: -0.419It 12/15, best obs.: , ei_hogp_cf: -0.020
/mnt/xarfuse/uid-22017/907c0fbc-seed-nspid4026533651_cgpid35640602-ns-4026533648/gpytorch/utils/cholesky.py:44: NumericalWarning:

A not p.d., added jitter of 1.0e-04 to the diagonal

I0712 102027.985 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 11.838584
I0712 102027.987 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.316It 13/15, best obs.: , ei: -0.419It 13/15, best obs.: , ei_hogp_cf: -0.020
I0712 102111.012 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 43.025202
I0712 102111.013 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.316It 14/15, best obs.: , ei: -0.419It 14/15, best obs.: , ei_hogp_cf: -0.020
I0712 102121.232 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 10.219100
I0712 102121.233 &lt;ipython-input-9-289fa74c7767&gt;:22] rnd: -0.316It 15/15, best obs.: , ei: -0.419It 15/15, best obs.: , ei_hogp_cf: -0.020
/mnt/xarfuse/uid-22017/907c0fbc-seed-nspid4026533651_cgpid35640602-ns-4026533648/gpytorch/utils/cholesky.py:44: NumericalWarning:

A not p.d., added jitter of 1.0e-04 to the diagonal

I0712 102213.324 &lt;ipython-input-9-289fa74c7767&gt;:80] Wall time: 52.091378
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Finished with trial:  3
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">methods_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">trial</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span> <span class="k">for</span> <span class="n">trial</span> <span class="ow">in</span> <span class="n">all_objective_vals</span><span class="p">])</span><span class="o">.</span><span class="n">cummax</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">models_used</span><span class="p">}</span>
<span class="n">mean_and_sem_results</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="p">[</span>
    <span class="o">-</span><span class="n">methods_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="n">n_init</span><span class="p">:],</span> 
    <span class="mf">2.</span> <span class="o">*</span> <span class="n">methods_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="n">n_init</span><span class="p">:]</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_trials</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">models_used</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we plot the results, showing that the HOGP performs well on this task, and converges to a closer parameter value than a batch GP on the composite metric itself.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">labels_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"rnd"</span><span class="p">:</span> <span class="s2">"Random"</span><span class="p">,</span> <span class="s2">"ei"</span><span class="p">:</span> <span class="s2">"EI"</span><span class="p">,</span> <span class="s2">"ei_hogp_cf"</span><span class="p">:</span> <span class="s2">"Composite EI"</span><span class="p">}</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">models_used</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_batches</span> <span class="o">*</span> <span class="n">batch_size</span><span class="p">),</span>
        <span class="n">mean_and_sem_results</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">labels_dict</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
    <span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_batches</span> <span class="o">*</span> <span class="n">batch_size</span><span class="p">),</span>
        <span class="p">(</span><span class="n">mean_and_sem_results</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">mean_and_sem_results</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">clamp</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">),</span>
        <span class="n">mean_and_sem_results</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">mean_and_sem_results</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span>
    <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"Number of Function Queries"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"Difference from True Parameter"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[11]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>Text(0, 0.5, 'Difference from True Parameter')</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea">
<img src="data:image/png;base64,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
"/>
</div>
</div>
</div>
</div>
</div>
</div></div><div class="tutorialButtonWrapper buttonWrapper"><a class="tutorialButton button" download="" href="/v/latest/files/composite_bo_with_hogp.ipynb" target="_blank"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="file-download" class="svg-inline--fa fa-file-download fa-w-12" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm76.45 211.36l-96.42 95.7c-6.65 6.61-17.39 6.61-24.04 0l-96.42-95.7C73.42 337.29 80.54 320 94.82 320H160v-80c0-8.84 7.16-16 16-16h32c8.84 0 16 7.16 16 16v80h65.18c14.28 0 21.4 17.29 11.27 27.36zM377 105L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9z"></path></svg>Download Tutorial Jupyter Notebook</a></div><div class="tutorialButtonWrapper buttonWrapper"><a class="tutorialButton button" download="" href="/v/latest/files/composite_bo_with_hogp.py" target="_blank"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="file-download" class="svg-inline--fa fa-file-download fa-w-12" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm76.45 211.36l-96.42 95.7c-6.65 6.61-17.39 6.61-24.04 0l-96.42-95.7C73.42 337.29 80.54 320 94.82 320H160v-80c0-8.84 7.16-16 16-16h32c8.84 0 16 7.16 16 16v80h65.18c14.28 0 21.4 17.29 11.27 27.36zM377 105L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9z"></path></svg>Download Tutorial Source Code</a></div></div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/v/latest/" class="nav-home"><img src="/v/latest/img/botorch.png" alt="BoTorch" width="66" height="58"/></a><div class="footerSection"><h5>Docs</h5><a href="/v/latest/docs/introduction">Introduction</a><a href="/v/latest/docs/getting_started">Getting Started</a><a href="/v/latest/tutorials/">Tutorials</a><a href="/v/latest/api/">API Reference</a><a href="https://arxiv.org/abs/1910.06403">Paper</a></div><div class="footerSection"><h5>Legal</h5><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noreferrer noopener">Privacy</a><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noreferrer noopener">Terms</a></div><div class="footerSection"><h5>Social</h5><div class="social"><a class="github-button" href="https://github.com/pytorch/botorch" data-count-href="https://github.com/pytorch/botorch/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star BoTorch on GitHub">botorch</a></div></div></section><a href="https://opensource.facebook.com/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/v/latest/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright"> Copyright © 2022 Meta Platforms Inc.</section><script>
            (function() {
              var BAD_BASE = '/botorch/';
              if (window.location.origin !== 'https://botorch.org') {
                var pathname = window.location.pathname;
                var newPathname = pathname.slice(pathname.indexOf(BAD_BASE) === 0 ? BAD_BASE.length : 1);
                var newLocation = 'https://botorch.org/v/latest/' + newPathname;
                console.log('redirecting to ' + newLocation);
                window.location.href = newLocation;
              }
            })();
          </script></footer></div></body></html>