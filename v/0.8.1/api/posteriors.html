<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>BoTorch · Bayesian Optimization in PyTorch</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="Bayesian Optimization in PyTorch"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="BoTorch · Bayesian Optimization in PyTorch"/><meta property="og:type" content="website"/><meta property="og:url" content="https://botorch.org/v/0.8.1/"/><meta property="og:description" content="Bayesian Optimization in PyTorch"/><meta property="og:image" content="https://botorch.org/v/0.8.1/img/botorch.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://botorch.org/v/0.8.1/img/botorch.png"/><link rel="shortcut icon" href="/v/0.8.1/img/botorch.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-139570076-2', 'auto');
              ga('send', 'pageview');
            </script><link rel="stylesheet" href="/v/0.8.1/css/code_block_buttons.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="/v/0.8.1/js/code_block_buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/v/0.8.1/js/mathjax.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/v/0.8.1/js/scrollSpy.js"></script><link rel="stylesheet" href="/v/0.8.1/css/main.css"/><script src="/v/0.8.1/js/codetabs.js"></script></head><body><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/v/0.8.1/"><img class="logo" src="/v/0.8.1/img/botorch_logo_lockup_white.png" alt="BoTorch"/><h2 class="headerTitleWithLogo">BoTorch</h2></a><a href="/v/0.8.1/versions"><h3>0.8.1</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/v/0.8.1/docs/introduction" target="_self">Docs</a></li><li class=""><a href="/v/0.8.1/tutorials/" target="_self">Tutorials</a></li><li class=""><a href="/v/0.8.1/api/" target="_self">API Reference</a></li><li class=""><a href="/v/0.8.1/docs/papers" target="_self">Papers</a></li><li class=""><a href="https://github.com/pytorch/botorch" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div>
<script type="text/javascript" id="documentation_options" data-url_root="./" src="/js/documentation_options.js"></script>
<script type="text/javascript" src="/js/jquery.js"></script>
<script type="text/javascript" src="/js/underscore.js"></script>
<script type="text/javascript" src="/js/doctools.js"></script>
<script type="text/javascript" src="/js/language_data.js"></script>
<script type="text/javascript" src="/js/searchtools.js"></script>
<div class="sphinx"><div class="document">
<div class="documentwrapper">
<div class="bodywrapper">
<div class="body" role="main">
<section id="module-botorch.posteriors">
<span id="botorch-posteriors"></span><h1>botorch.posteriors<a class="headerlink" href="#module-botorch.posteriors" title="Permalink to this heading">¶</a></h1>
<section id="posterior-apis">
<h2>Posterior APIs<a class="headerlink" href="#posterior-apis" title="Permalink to this heading">¶</a></h2>
<section id="module-botorch.posteriors.posterior">
<span id="abstract-posterior-api"></span><h3>Abstract Posterior API<a class="headerlink" href="#module-botorch.posteriors.posterior" title="Permalink to this heading">¶</a></h3>
<p>Abstract base module for all botorch posteriors.</p>
</section>
<section id="module-botorch.posteriors.posterior_list">
<span id="posterior-list-api"></span><h3>Posterior List API<a class="headerlink" href="#module-botorch.posteriors.posterior_list" title="Permalink to this heading">¶</a></h3>
<p>Abstract base module for all botorch posteriors.</p>
<dl class="py class">
<dt class="sig sig-object py" id="botorch.posteriors.posterior_list.PosteriorList">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">botorch.posteriors.posterior_list.</span></span><span class="sig-name descname"><span class="pre">PosteriorList</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">posteriors</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/botorch/posteriors/posterior_list.html#PosteriorList"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#botorch.posteriors.posterior_list.PosteriorList" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Posterior</span></code></p>
<p>A Posterior represented by a list of independent Posteriors.</p>
<p>When at least one of the posteriors is a <cite>FullyBayesianPosterior</cite>, the other
posteriors are expanded to match the size of the <cite>FullyBayesianPosterior</cite>.</p>
<p>A Posterior represented by a list of independent Posteriors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*posteriors</strong> (<em>Posterior</em>) – A variable number of single-outcome posteriors.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p_1</span> <span class="o">=</span> <span class="n">model_1</span><span class="o">.</span><span class="n">posterior</span><span class="p">(</span><span class="n">test_X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_2</span> <span class="o">=</span> <span class="n">model_2</span><span class="o">.</span><span class="n">posterior</span><span class="p">(</span><span class="n">test_X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_12</span> <span class="o">=</span> <span class="n">PosteriorList</span><span class="p">(</span><span class="n">p_1</span><span class="p">,</span> <span class="n">p_2</span><span class="p">)</span>
</pre></div>
</div>
<p>Note: This is typically produced automatically in <cite>ModelList</cite>; it should
generally not be necessary for the end user to invoke it manually.</p>
<dl class="py property">
<dt class="sig sig-object py" id="botorch.posteriors.posterior_list.PosteriorList.device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">device</span></em><a class="headerlink" href="#botorch.posteriors.posterior_list.PosteriorList.device" title="Permalink to this definition">¶</a></dt>
<dd><p>The torch device of the posterior.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="botorch.posteriors.posterior_list.PosteriorList.dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtype</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dtype</span></em><a class="headerlink" href="#botorch.posteriors.posterior_list.PosteriorList.dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>The torch dtype of the posterior.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="botorch.posteriors.posterior_list.PosteriorList.mean">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mean</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#botorch.posteriors.posterior_list.PosteriorList.mean" title="Permalink to this definition">¶</a></dt>
<dd><p>The mean of the posterior as a <cite>(b) x n x m</cite>-dim Tensor.</p>
<p>This is only supported if all posteriors provide a mean.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="botorch.posteriors.posterior_list.PosteriorList.variance">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">variance</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#botorch.posteriors.posterior_list.PosteriorList.variance" title="Permalink to this definition">¶</a></dt>
<dd><p>The variance of the posterior as a <cite>(b) x n x m</cite>-dim Tensor.</p>
<p>This is only supported if all posteriors provide a variance.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="botorch.posteriors.posterior_list.PosteriorList.rsample">
<span class="sig-name descname"><span class="pre">rsample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/botorch/posteriors/posterior_list.html#PosteriorList.rsample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#botorch.posteriors.posterior_list.PosteriorList.rsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample from the posterior (with gradients).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample_shape</strong> (<em>Optional</em><em>[</em><em>Size</em><em>]</em>) – A <cite>torch.Size</cite> object specifying the sample shape. To
draw <cite>n</cite> samples, set to <cite>torch.Size([n])</cite>. To draw <cite>b</cite> batches
of <cite>n</cite> samples each, set to <cite>torch.Size([b, n])</cite>.</p></li>
<li><p><strong>base_samples</strong> – An (optional) Tensor of <cite>N(0, I)</cite> base samples of
appropriate dimension, typically obtained from a <cite>Sampler</cite>.
This is used for deterministic optimization. Deprecated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Samples from the posterior, a tensor of shape
<cite>self._extended_shape(sample_shape=sample_shape)</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>
</dd></dl>
</section>
</section>
<section id="posteriors">
<h2>Posteriors<a class="headerlink" href="#posteriors" title="Permalink to this heading">¶</a></h2>
<section id="module-botorch.posteriors.torch">
<span id="torch-posterior"></span><h3>Torch Posterior<a class="headerlink" href="#module-botorch.posteriors.torch" title="Permalink to this heading">¶</a></h3>
<p>Posterior module to be used with PyTorch distributions.</p>
<dl class="py class">
<dt class="sig sig-object py" id="botorch.posteriors.torch.TorchPosterior">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">botorch.posteriors.torch.</span></span><span class="sig-name descname"><span class="pre">TorchPosterior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distribution</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/botorch/posteriors/torch.html#TorchPosterior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#botorch.posteriors.torch.TorchPosterior" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Posterior</span></code></p>
<p>A posterior based on a PyTorch Distribution.</p>
<p>NOTE: For any attribute that is not explicitly defined on the Posterior level, this
returns the corresponding attribute of the distribution. This allows easy access
to the distribution attributes, without having to expose them on the Posterior.</p>
<p>A posterior based on a PyTorch Distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>distribution</strong> (<em>Distribution</em>) – A PyTorch Distribution object.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="botorch.posteriors.torch.TorchPosterior.rsample">
<span class="sig-name descname"><span class="pre">rsample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/botorch/posteriors/torch.html#TorchPosterior.rsample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#botorch.posteriors.torch.TorchPosterior.rsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample from the posterior (with gradients).</p>
<p>This is generally used with a sampler that produces the base samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sample_shape</strong> (<em>Optional</em><em>[</em><em>Size</em><em>]</em>) – A <cite>torch.Size</cite> object specifying the sample shape. To
draw <cite>n</cite> samples, set to <cite>torch.Size([n])</cite>. To draw <cite>b</cite> batches
of <cite>n</cite> samples each, set to <cite>torch.Size([b, n])</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Samples from the posterior, a tensor of shape
<cite>self._extended_shape(sample_shape=sample_shape)</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="botorch.posteriors.torch.TorchPosterior.device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">device</span></em><a class="headerlink" href="#botorch.posteriors.torch.TorchPosterior.device" title="Permalink to this definition">¶</a></dt>
<dd><p>The torch device of the distribution.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="botorch.posteriors.torch.TorchPosterior.dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtype</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dtype</span></em><a class="headerlink" href="#botorch.posteriors.torch.TorchPosterior.dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>The torch dtype of the distribution.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="botorch.posteriors.torch.TorchPosterior.quantile">
<span class="sig-name descname"><span class="pre">quantile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/botorch/posteriors/torch.html#TorchPosterior.quantile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#botorch.posteriors.torch.TorchPosterior.quantile" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute quantiles of the distribution.</p>
<p>For multi-variate distributions, this may return the quantiles of
the marginal distributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>Tensor</em>) – </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="botorch.posteriors.torch.TorchPosterior.density">
<span class="sig-name descname"><span class="pre">density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/botorch/posteriors/torch.html#TorchPosterior.density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#botorch.posteriors.torch.TorchPosterior.density" title="Permalink to this definition">¶</a></dt>
<dd><p>The probability density (or mass if discrete) of the distribution.</p>
<p>For multi-variate distributions, this may return the density of
the marginal distributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>Tensor</em>) – </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>
</dd></dl>
</section>
<section id="module-botorch.posteriors.gpytorch">
<span id="gpytorch-posterior"></span><h3>GPyTorch Posterior<a class="headerlink" href="#module-botorch.posteriors.gpytorch" title="Permalink to this heading">¶</a></h3>
<p>Posterior module to be used with GPyTorch models.</p>
<dl class="py class">
<dt class="sig sig-object py" id="botorch.posteriors.gpytorch.GPyTorchPosterior">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">botorch.posteriors.gpytorch.</span></span><span class="sig-name descname"><span class="pre">GPyTorchPosterior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distribution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mvn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/botorch/posteriors/gpytorch.html#GPyTorchPosterior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#botorch.posteriors.gpytorch.GPyTorchPosterior" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#botorch.posteriors.torch.TorchPosterior" title="botorch.posteriors.torch.TorchPosterior"><code class="xref py py-class docutils literal notranslate"><span class="pre">TorchPosterior</span></code></a></p>
<p>A posterior based on GPyTorch’s multi-variate Normal distributions.</p>
<p>A posterior based on GPyTorch’s multi-variate Normal distributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>distribution</strong> (<em>MultivariateNormal</em>) – A GPyTorch MultivariateNormal (single-output case) or
MultitaskMultivariateNormal (multi-output case).</p></li>
<li><p><strong>mvn</strong> (<em>Optional</em><em>[</em><em>MultivariateNormal</em><em>]</em>) – Deprecated.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="botorch.posteriors.gpytorch.GPyTorchPosterior.distribution">
<span class="sig-name descname"><span class="pre">distribution</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">MultivariateNormal</span></em><a class="headerlink" href="#botorch.posteriors.gpytorch.GPyTorchPosterior.distribution" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="botorch.posteriors.gpytorch.GPyTorchPosterior.mvn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mvn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">MultivariateNormal</span></em><a class="headerlink" href="#botorch.posteriors.gpytorch.GPyTorchPosterior.mvn" title="Permalink to this definition">¶</a></dt>
<dd><p>Expose the distribution as a backwards-compatible attribute.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="botorch.posteriors.gpytorch.GPyTorchPosterior.base_sample_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">base_sample_shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Size</span></em><a class="headerlink" href="#botorch.posteriors.gpytorch.GPyTorchPosterior.base_sample_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>The shape of a base sample used for constructing posterior samples.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="botorch.posteriors.gpytorch.GPyTorchPosterior.batch_range">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">batch_range</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#botorch.posteriors.gpytorch.GPyTorchPosterior.batch_range" title="Permalink to this definition">¶</a></dt>
<dd><p>The t-batch range.</p>
<p>This is used in samplers to identify the t-batch component of the
<cite>base_sample_shape</cite>. The base samples are expanded over the t-batches to
provide consistency in the acquisition values, i.e., to ensure that a
candidate produces same value regardless of its position on the t-batch.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="botorch.posteriors.gpytorch.GPyTorchPosterior.rsample_from_base_samples">
<span class="sig-name descname"><span class="pre">rsample_from_base_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/botorch/posteriors/gpytorch.html#GPyTorchPosterior.rsample_from_base_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#botorch.posteriors.gpytorch.GPyTorchPosterior.rsample_from_base_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample from the posterior (with gradients) using base samples.</p>
<p>This is intended to be used with a sampler that produces the corresponding base
samples, and enables acquisition optimization via Sample Average Approximation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample_shape</strong> (<em>Size</em>) – A <cite>torch.Size</cite> object specifying the sample shape. To
draw <cite>n</cite> samples, set to <cite>torch.Size([n])</cite>. To draw <cite>b</cite> batches
of <cite>n</cite> samples each, set to <cite>torch.Size([b, n])</cite>.</p></li>
<li><p><strong>base_samples</strong> (<em>Tensor</em>) – A Tensor of <cite>N(0, I)</cite> base samples of shape
<cite>sample_shape x base_sample_shape</cite>, typically obtained from
a <cite>Sampler</cite>. This is used for deterministic optimization.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Samples from the posterior, a tensor of shape
<cite>self._extended_shape(sample_shape=sample_shape)</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="botorch.posteriors.gpytorch.GPyTorchPosterior.rsample">
<span class="sig-name descname"><span class="pre">rsample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/botorch/posteriors/gpytorch.html#GPyTorchPosterior.rsample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#botorch.posteriors.gpytorch.GPyTorchPosterior.rsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample from the posterior (with gradients).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample_shape</strong> (<em>Optional</em><em>[</em><em>Size</em><em>]</em>) – A <cite>torch.Size</cite> object specifying the sample shape. To
draw <cite>n</cite> samples, set to <cite>torch.Size([n])</cite>. To draw <cite>b</cite> batches
of <cite>n</cite> samples each, set to <cite>torch.Size([b, n])</cite>.</p></li>
<li><p><strong>base_samples</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – An (optional) Tensor of <cite>N(0, I)</cite> base samples of
appropriate dimension, typically obtained from a <cite>Sampler</cite>.
This is used for deterministic optimization.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Samples from the posterior, a tensor of shape
<cite>self._extended_shape(sample_shape=sample_shape)</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="botorch.posteriors.gpytorch.GPyTorchPosterior.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/botorch/posteriors/gpytorch.html#GPyTorchPosterior.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#botorch.posteriors.gpytorch.GPyTorchPosterior.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample from the posterior without gradients.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sample_shape</strong> (<em>Optional</em><em>[</em><em>Size</em><em>]</em>) – A <cite>torch.Size</cite> object specifying the sample shape. To
draw <cite>n</cite> samples, set to <cite>torch.Size([n])</cite>. To draw <cite>b</cite> batches
of <cite>n</cite> samples each, set to <cite>torch.Size([b, n])</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Samples from the posterior, a tensor of shape
<cite>self._extended_shape(sample_shape=sample_shape)</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="botorch.posteriors.gpytorch.GPyTorchPosterior.mean">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mean</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#botorch.posteriors.gpytorch.GPyTorchPosterior.mean" title="Permalink to this definition">¶</a></dt>
<dd><p>The posterior mean.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="botorch.posteriors.gpytorch.GPyTorchPosterior.variance">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">variance</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#botorch.posteriors.gpytorch.GPyTorchPosterior.variance" title="Permalink to this definition">¶</a></dt>
<dd><p>The posterior variance.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="botorch.posteriors.gpytorch.GPyTorchPosterior.quantile">
<span class="sig-name descname"><span class="pre">quantile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/botorch/posteriors/gpytorch.html#GPyTorchPosterior.quantile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#botorch.posteriors.gpytorch.GPyTorchPosterior.quantile" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the quantiles of the marginal distributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>Tensor</em>) – </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="botorch.posteriors.gpytorch.GPyTorchPosterior.density">
<span class="sig-name descname"><span class="pre">density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/botorch/posteriors/gpytorch.html#GPyTorchPosterior.density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#botorch.posteriors.gpytorch.GPyTorchPosterior.density" title="Permalink to this definition">¶</a></dt>
<dd><p>The probability density of the marginal distributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>Tensor</em>) – </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="botorch.posteriors.gpytorch.scalarize_posterior_gpytorch">
<span class="sig-prename descclassname"><span class="pre">botorch.posteriors.gpytorch.</span></span><span class="sig-name descname"><span class="pre">scalarize_posterior_gpytorch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">posterior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/botorch/posteriors/gpytorch.html#scalarize_posterior_gpytorch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#botorch.posteriors.gpytorch.scalarize_posterior_gpytorch" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function for <cite>scalarize_posterior</cite>, producing a mean and
variance.</p>
<p>This mean and variance are consumed by <cite>scalarize_posterior</cite> to produce
a <cite>GPyTorchPosterior</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>posterior</strong> (<a class="reference internal" href="#botorch.posteriors.gpytorch.GPyTorchPosterior" title="botorch.posteriors.gpytorch.GPyTorchPosterior"><em>GPyTorchPosterior</em></a>) – The posterior over <cite>m</cite> outcomes to be scalarized.
Supports <cite>t</cite>-batching.</p></li>
<li><p><strong>weights</strong> (<em>Tensor</em>) – A tensor of weights of size <cite>m</cite>.</p></li>
<li><p><strong>offset</strong> (<em>float</em>) – The offset of the affine transformation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>The transformed (single-output) posterior. If the input posterior has</dt><dd><p>mean <cite>mu</cite> and covariance matrix <cite>Sigma</cite>, this posterior has mean
<cite>weights^T * mu</cite> and variance <cite>weights^T Sigma w</cite>.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[<em>Tensor</em>, <em>Union</em>[<em>Tensor</em>, <em>LinearOperator</em>]]</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Example for a model with two outcomes:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">posterior</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">posterior</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span><span class="p">,</span> <span class="n">cov</span> <span class="o">=</span> <span class="n">scalarize_posterior_gpytorch</span><span class="p">(</span><span class="n">posterior</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mvn</span> <span class="o">=</span> <span class="n">MultivariateNormal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">cov</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_posterior</span> <span class="o">=</span> <span class="n">GPyTorchPosterior</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="botorch.posteriors.gpytorch.scalarize_posterior">
<span class="sig-prename descclassname"><span class="pre">botorch.posteriors.gpytorch.</span></span><span class="sig-name descname"><span class="pre">scalarize_posterior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">posterior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/botorch/posteriors/gpytorch.html#scalarize_posterior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#botorch.posteriors.gpytorch.scalarize_posterior" title="Permalink to this definition">¶</a></dt>
<dd><p>Affine transformation of a multi-output posterior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>posterior</strong> (<em>Union</em><em>[</em><a class="reference internal" href="#botorch.posteriors.gpytorch.GPyTorchPosterior" title="botorch.posteriors.gpytorch.GPyTorchPosterior"><em>GPyTorchPosterior</em></a><em>, </em><a class="reference internal" href="#botorch.posteriors.posterior_list.PosteriorList" title="botorch.posteriors.posterior_list.PosteriorList"><em>PosteriorList</em></a><em>]</em>) – The posterior over <cite>m</cite> outcomes to be scalarized.
Supports <cite>t</cite>-batching. Can be either a <cite>GPyTorchPosterior</cite>,
or a <cite>PosteriorList</cite> that contains GPyTorchPosteriors all with q=1.</p></li>
<li><p><strong>weights</strong> (<em>Tensor</em>) – A tensor of weights of size <cite>m</cite>.</p></li>
<li><p><strong>offset</strong> (<em>float</em>) – The offset of the affine transformation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>The transformed (single-output) posterior. If the input posterior has</dt><dd><p>mean <cite>mu</cite> and covariance matrix <cite>Sigma</cite>, this posterior has mean
<cite>weights^T * mu</cite> and variance <cite>weights^T Sigma w</cite>.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#botorch.posteriors.gpytorch.GPyTorchPosterior" title="botorch.posteriors.gpytorch.GPyTorchPosterior">GPyTorchPosterior</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Example for a model with two outcomes:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">posterior</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">posterior</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_posterior</span> <span class="o">=</span> <span class="n">scalarize_posterior</span><span class="p">(</span><span class="n">posterior</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>
</section>
<section id="module-botorch.posteriors.deterministic">
<span id="determinstic-posterior"></span><h3>Determinstic Posterior<a class="headerlink" href="#module-botorch.posteriors.deterministic" title="Permalink to this heading">¶</a></h3>
<p>Deterministic (degenerate) posteriors. Used in conjunction with deterministic
models.</p>
<dl class="py class">
<dt class="sig sig-object py" id="botorch.posteriors.deterministic.DeterministicPosterior">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">botorch.posteriors.deterministic.</span></span><span class="sig-name descname"><span class="pre">DeterministicPosterior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/botorch/posteriors/deterministic.html#DeterministicPosterior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#botorch.posteriors.deterministic.DeterministicPosterior" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Posterior</span></code></p>
<p>Deterministic posterior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>values</strong> (<em>Tensor</em>) – Values of the samples produced by this posterior.</p>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="botorch.posteriors.deterministic.DeterministicPosterior.device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">device</span></em><a class="headerlink" href="#botorch.posteriors.deterministic.DeterministicPosterior.device" title="Permalink to this definition">¶</a></dt>
<dd><p>The torch device of the posterior.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="botorch.posteriors.deterministic.DeterministicPosterior.dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtype</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dtype</span></em><a class="headerlink" href="#botorch.posteriors.deterministic.DeterministicPosterior.dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>The torch dtype of the posterior.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="botorch.posteriors.deterministic.DeterministicPosterior.mean">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mean</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#botorch.posteriors.deterministic.DeterministicPosterior.mean" title="Permalink to this definition">¶</a></dt>
<dd><p>The mean of the posterior as a <cite>(b) x n x m</cite>-dim Tensor.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="botorch.posteriors.deterministic.DeterministicPosterior.variance">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">variance</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#botorch.posteriors.deterministic.DeterministicPosterior.variance" title="Permalink to this definition">¶</a></dt>
<dd><p>The variance of the posterior as a <cite>(b) x n x m</cite>-dim Tensor.</p>
<p>As this is a deterministic posterior, this is a tensor of zeros.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="botorch.posteriors.deterministic.DeterministicPosterior.rsample">
<span class="sig-name descname"><span class="pre">rsample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/botorch/posteriors/deterministic.html#DeterministicPosterior.rsample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#botorch.posteriors.deterministic.DeterministicPosterior.rsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample from the posterior (with gradients).</p>
<p>For the deterministic posterior, this just returns the values expanded
to the requested shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sample_shape</strong> (<em>Optional</em><em>[</em><em>Size</em><em>]</em>) – A <cite>torch.Size</cite> object specifying the sample shape. To
draw <cite>n</cite> samples, set to <cite>torch.Size([n])</cite>. To draw <cite>b</cite> batches
of <cite>n</cite> samples each, set to <cite>torch.Size([b, n])</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Samples from the posterior, a tensor of shape
<cite>self._extended_shape(sample_shape=sample_shape)</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>
</dd></dl>
</section>
<section id="module-botorch.posteriors.higher_order">
<span id="higher-order-gp-posterior"></span><h3>Higher Order GP Posterior<a class="headerlink" href="#module-botorch.posteriors.higher_order" title="Permalink to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="botorch.posteriors.higher_order.HigherOrderGPPosterior">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">botorch.posteriors.higher_order.</span></span><span class="sig-name descname"><span class="pre">HigherOrderGPPosterior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distribution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">joint_covariance_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_train_covar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_train_covar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_outputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/botorch/posteriors/higher_order.html#HigherOrderGPPosterior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#botorch.posteriors.higher_order.HigherOrderGPPosterior" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#botorch.posteriors.gpytorch.GPyTorchPosterior" title="botorch.posteriors.gpytorch.GPyTorchPosterior"><code class="xref py py-class docutils literal notranslate"><span class="pre">GPyTorchPosterior</span></code></a></p>
<p>Posterior class for a Higher order Gaussian process model <a class="reference internal" href="models.html#zhe2019hogp" id="id1"><span>[Zhe2019hogp]</span></a>. Extends
the standard GPyTorch posterior class by overwriting the rsample method.
The posterior variance is handled internally by the HigherOrderGP model.
HOGP is a tensorized GP model so the posterior covariance grows to be extremely
large, but is highly structured, which means that we can exploit Kronecker
identities to sample from the posterior using Matheron’s rule as described in
<a class="reference internal" href="models.html#doucet2010sampl" id="id2"><span>[Doucet2010sampl]</span></a>.</p>
<p>In general, this posterior should ONLY be used for HOGP models
that have highly structured covariances. It should also only be used internally when
called from the HigherOrderGP.posterior(…) method. At this time, the posterior
does not support gradients with respect to the training data.</p>
<p>A Posterior for HigherOrderGP models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>distribution</strong> (<em>MultivariateNormal</em>) – Posterior multivariate normal distribution.</p></li>
<li><p><strong>joint_covariance_matrix</strong> (<em>LinearOperator</em>) – Joint test train covariance matrix over the entire
tensor.</p></li>
<li><p><strong>train_train_covar</strong> (<em>LinearOperator</em>) – Covariance matrix of train points in the data space.</p></li>
<li><p><strong>test_train_covar</strong> (<em>LinearOperator</em>) – Covariance matrix of test x train points
in the data space.</p></li>
<li><p><strong>train_targets</strong> (<em>Tensor</em>) – Training responses vectorized.</p></li>
<li><p><strong>output_shape</strong> (<em>Size</em>) – Shape output training responses.</p></li>
<li><p><strong>num_outputs</strong> (<em>int</em>) – Batch shaping of model.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="botorch.posteriors.higher_order.HigherOrderGPPosterior.base_sample_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">base_sample_shape</span></span><a class="headerlink" href="#botorch.posteriors.higher_order.HigherOrderGPPosterior.base_sample_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>The shape of a base sample used for constructing posterior samples.</p>
<p>Overwrites the standard <cite>base_sample_shape</cite> call to inform samplers that
<cite>n + 2 n_train</cite> samples need to be drawn rather than n samples.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="botorch.posteriors.higher_order.HigherOrderGPPosterior.batch_range">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">batch_range</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#botorch.posteriors.higher_order.HigherOrderGPPosterior.batch_range" title="Permalink to this definition">¶</a></dt>
<dd><p>The t-batch range.</p>
<p>This is used in samplers to identify the t-batch component of the
<cite>base_sample_shape</cite>. The base samples are expanded over the t-batches to
provide consistency in the acquisition values, i.e., to ensure that a
candidate produces same value regardless of its position on the t-batch.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="botorch.posteriors.higher_order.HigherOrderGPPosterior.rsample_from_base_samples">
<span class="sig-name descname"><span class="pre">rsample_from_base_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/botorch/posteriors/higher_order.html#HigherOrderGPPosterior.rsample_from_base_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#botorch.posteriors.higher_order.HigherOrderGPPosterior.rsample_from_base_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample from the posterior (with gradients) using base samples.</p>
<p>As the posterior covariance is difficult to draw from in this model,
we implement Matheron’s rule as described in [Doucet2010sampl]-. This may not
work entirely correctly for deterministic base samples unless base samples
are provided that are of shape <cite>n + 2 * n_train</cite> because the sampling method
draws <cite>2 * n_train</cite> samples as well as the standard <cite>n</cite>.
samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample_shape</strong> (<em>Size</em>) – A <cite>torch.Size</cite> object specifying the sample shape. To
draw <cite>n</cite> samples, set to <cite>torch.Size([n])</cite>. To draw <cite>b</cite> batches
of <cite>n</cite> samples each, set to <cite>torch.Size([b, n])</cite>.</p></li>
<li><p><strong>base_samples</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – An (optional) Tensor of <cite>N(0, I)</cite> base samples of
appropriate dimension, typically obtained from a <cite>Sampler</cite>.
This is used for deterministic optimization.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Samples from the posterior, a tensor of shape
<cite>self._extended_shape(sample_shape=sample_shape)</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="botorch.posteriors.higher_order.HigherOrderGPPosterior.rsample">
<span class="sig-name descname"><span class="pre">rsample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/botorch/posteriors/higher_order.html#HigherOrderGPPosterior.rsample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#botorch.posteriors.higher_order.HigherOrderGPPosterior.rsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample from the posterior (with gradients).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sample_shape</strong> (<em>Optional</em><em>[</em><em>Size</em><em>]</em>) – A <cite>torch.Size</cite> object specifying the sample shape. To
draw <cite>n</cite> samples, set to <cite>torch.Size([n])</cite>. To draw <cite>b</cite> batches
of <cite>n</cite> samples each, set to <cite>torch.Size([b, n])</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Samples from the posterior, a tensor of shape
<cite>self._extended_shape(sample_shape=sample_shape)</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="botorch.posteriors.higher_order.HigherOrderGPPosterior.distribution">
<span class="sig-name descname"><span class="pre">distribution</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">MultivariateNormal</span></em><a class="headerlink" href="#botorch.posteriors.higher_order.HigherOrderGPPosterior.distribution" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
</dd></dl>
</section>
<section id="module-botorch.posteriors.multitask">
<span id="multitask-gp-posterior"></span><h3>Multitask GP Posterior<a class="headerlink" href="#module-botorch.posteriors.multitask" title="Permalink to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="botorch.posteriors.multitask.MultitaskGPPosterior">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">botorch.posteriors.multitask.</span></span><span class="sig-name descname"><span class="pre">MultitaskGPPosterior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distribution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">joint_covariance_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_train_covar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_diff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_train_covar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_noise</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/botorch/posteriors/multitask.html#MultitaskGPPosterior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#botorch.posteriors.multitask.MultitaskGPPosterior" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#botorch.posteriors.gpytorch.GPyTorchPosterior" title="botorch.posteriors.gpytorch.GPyTorchPosterior"><code class="xref py py-class docutils literal notranslate"><span class="pre">GPyTorchPosterior</span></code></a></p>
<p>Posterior class for a Kronecker Multi-task GP model using with ICM kernel.
Extends the standard GPyTorch posterior class by overwriting the rsample
method. In general, this posterior should ONLY be used for MTGP models
that have structured covariances. It should also only be used internally when
called from the <cite>KroneckerMultiTaskGP.posterior(…)</cite> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>distribution</strong> (<em>MultivariateNormal</em>) – Posterior multivariate normal distribution.</p></li>
<li><p><strong>joint_covariance_matrix</strong> (<em>LinearOperator</em>) – Joint test train covariance matrix over the entire
tensor.</p></li>
<li><p><strong>train_train_covar</strong> (<em>LinearOperator</em>) – Covariance matrix of train points in the data space.</p></li>
<li><p><strong>test_obs_covar</strong> – Covariance matrix of test x train points in the data space.</p></li>
<li><p><strong>train_diff</strong> (<em>Tensor</em>) – Difference between train mean and train responses.</p></li>
<li><p><strong>train_noise</strong> (<em>Union</em><em>[</em><em>LinearOperator</em><em>, </em><em>Tensor</em><em>]</em>) – Training noise covariance.</p></li>
<li><p><strong>test_noise</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>LinearOperator</em><em>, </em><em>Tensor</em><em>]</em><em>]</em>) – Only used if posterior should contain observation noise.
Testing noise covariance.</p></li>
<li><p><strong>test_train_covar</strong> (<em>LinearOperator</em>) – </p></li>
<li><p><strong>test_mean</strong> (<em>Tensor</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="botorch.posteriors.multitask.MultitaskGPPosterior.base_sample_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">base_sample_shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Size</span></em><a class="headerlink" href="#botorch.posteriors.multitask.MultitaskGPPosterior.base_sample_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>The shape of a base sample used for constructing posterior samples.</p>
<p>Overwrites the standard <cite>base_sample_shape</cite> call to inform samplers that
<cite>n + 2 n_train</cite> samples need to be drawn rather than n samples.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="botorch.posteriors.multitask.MultitaskGPPosterior.batch_range">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">batch_range</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#botorch.posteriors.multitask.MultitaskGPPosterior.batch_range" title="Permalink to this definition">¶</a></dt>
<dd><p>The t-batch range.</p>
<p>This is used in samplers to identify the t-batch component of the
<cite>base_sample_shape</cite>. The base samples are expanded over the t-batches to
provide consistency in the acquisition values, i.e., to ensure that a
candidate produces same value regardless of its position on the t-batch.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="botorch.posteriors.multitask.MultitaskGPPosterior.rsample_from_base_samples">
<span class="sig-name descname"><span class="pre">rsample_from_base_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_diff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/botorch/posteriors/multitask.html#MultitaskGPPosterior.rsample_from_base_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#botorch.posteriors.multitask.MultitaskGPPosterior.rsample_from_base_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample from the posterior (with gradients) using base samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample_shape</strong> (<em>Size</em>) – A <cite>torch.Size</cite> object specifying the sample shape. To
draw <cite>n</cite> samples, set to <cite>torch.Size([n])</cite>. To draw <cite>b</cite> batches
of <cite>n</cite> samples each, set to <cite>torch.Size([b, n])</cite>.</p></li>
<li><p><strong>base_samples</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – An (optional) Tensor of <cite>N(0, I)</cite> base samples of
appropriate dimension, typically obtained from a <cite>Sampler</cite>.
This is used for deterministic optimization.</p></li>
<li><p><strong>train_diff</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – Difference between train mean and train responses to assume
during sampling.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Samples from the posterior, a tensor of shape
<cite>self._extended_shape(sample_shape=sample_shape)</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="botorch.posteriors.multitask.MultitaskGPPosterior.rsample">
<span class="sig-name descname"><span class="pre">rsample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/botorch/posteriors/multitask.html#MultitaskGPPosterior.rsample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#botorch.posteriors.multitask.MultitaskGPPosterior.rsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample from the posterior (with gradients).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sample_shape</strong> (<em>Optional</em><em>[</em><em>Size</em><em>]</em>) – A <cite>torch.Size</cite> object specifying the sample shape. To
draw <cite>n</cite> samples, set to <cite>torch.Size([n])</cite>. To draw <cite>b</cite> batches
of <cite>n</cite> samples each, set to <cite>torch.Size([b, n])</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Samples from the posterior, a tensor of shape
<cite>self._extended_shape(sample_shape=sample_shape)</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="botorch.posteriors.multitask.MultitaskGPPosterior.distribution">
<span class="sig-name descname"><span class="pre">distribution</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">MultivariateNormal</span></em><a class="headerlink" href="#botorch.posteriors.multitask.MultitaskGPPosterior.distribution" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
</dd></dl>
</section>
<section id="module-botorch.posteriors.transformed">
<span id="transformed-posterior"></span><h3>Transformed Posterior<a class="headerlink" href="#module-botorch.posteriors.transformed" title="Permalink to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="botorch.posteriors.transformed.TransformedPosterior">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">botorch.posteriors.transformed.</span></span><span class="sig-name descname"><span class="pre">TransformedPosterior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">posterior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_transform</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/botorch/posteriors/transformed.html#TransformedPosterior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#botorch.posteriors.transformed.TransformedPosterior" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Posterior</span></code></p>
<p>A generic transformation of a posterior (implicitly represented).</p>
<p>An implicitly represented transformed posterior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>posterior</strong> (<em>Posterior</em>) – The posterior object to be transformed.</p></li>
<li><p><strong>sample_transform</strong> (<em>Callable</em><em>[</em><em>[</em><em>Tensor</em><em>]</em><em>, </em><em>Tensor</em><em>]</em>) – A callable applying a sample-level transform to a
<cite>sample_shape x batch_shape x q x m</cite>-dim tensor of samples from
the original posterior, returning a tensor of samples of the
same shape.</p></li>
<li><p><strong>mean_transform</strong> (<em>Optional</em><em>[</em><em>Callable</em><em>[</em><em>[</em><em>Tensor</em><em>, </em><em>Tensor</em><em>]</em><em>, </em><em>Tensor</em><em>]</em><em>]</em>) – A callable transforming a 2-tuple of mean and
variance (both of shape <cite>batch_shape x m x o</cite>) of the original
posterior to the mean of the transformed posterior.</p></li>
<li><p><strong>variance_transform</strong> (<em>Optional</em><em>[</em><em>Callable</em><em>[</em><em>[</em><em>Tensor</em><em>, </em><em>Tensor</em><em>]</em><em>, </em><em>Tensor</em><em>]</em><em>]</em>) – A callable transforming a 2-tuple of mean and
variance (both of shape <cite>batch_shape x m x o</cite>) of the original
posterior to a variance of the transformed posterior.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="botorch.posteriors.transformed.TransformedPosterior.base_sample_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">base_sample_shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Size</span></em><a class="headerlink" href="#botorch.posteriors.transformed.TransformedPosterior.base_sample_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>The shape of a base sample used for constructing posterior samples.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="botorch.posteriors.transformed.TransformedPosterior.batch_range">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">batch_range</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#botorch.posteriors.transformed.TransformedPosterior.batch_range" title="Permalink to this definition">¶</a></dt>
<dd><p>The t-batch range.</p>
<p>This is used in samplers to identify the t-batch component of the
<cite>base_sample_shape</cite>. The base samples are expanded over the t-batches to
provide consistency in the acquisition values, i.e., to ensure that a
candidate produces same value regardless of its position on the t-batch.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="botorch.posteriors.transformed.TransformedPosterior.device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">device</span></em><a class="headerlink" href="#botorch.posteriors.transformed.TransformedPosterior.device" title="Permalink to this definition">¶</a></dt>
<dd><p>The torch device of the posterior.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="botorch.posteriors.transformed.TransformedPosterior.dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtype</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dtype</span></em><a class="headerlink" href="#botorch.posteriors.transformed.TransformedPosterior.dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>The torch dtype of the posterior.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="botorch.posteriors.transformed.TransformedPosterior.mean">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mean</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#botorch.posteriors.transformed.TransformedPosterior.mean" title="Permalink to this definition">¶</a></dt>
<dd><p>The mean of the posterior as a <cite>batch_shape x n x m</cite>-dim Tensor.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="botorch.posteriors.transformed.TransformedPosterior.variance">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">variance</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#botorch.posteriors.transformed.TransformedPosterior.variance" title="Permalink to this definition">¶</a></dt>
<dd><p>The variance of the posterior as a <cite>batch_shape x n x m</cite>-dim Tensor.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="botorch.posteriors.transformed.TransformedPosterior.rsample_from_base_samples">
<span class="sig-name descname"><span class="pre">rsample_from_base_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/botorch/posteriors/transformed.html#TransformedPosterior.rsample_from_base_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#botorch.posteriors.transformed.TransformedPosterior.rsample_from_base_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample from the posterior (with gradients) using base samples.</p>
<p>This is intended to be used with a sampler that produces the corresponding base
samples, and enables acquisition optimization via Sample Average Approximation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample_shape</strong> (<em>Size</em>) – A <cite>torch.Size</cite> object specifying the sample shape. To
draw <cite>n</cite> samples, set to <cite>torch.Size([n])</cite>. To draw <cite>b</cite> batches
of <cite>n</cite> samples each, set to <cite>torch.Size([b, n])</cite>.</p></li>
<li><p><strong>base_samples</strong> (<em>Tensor</em>) – The base samples, obtained from the appropriate sampler.
This is a tensor of shape <cite>sample_shape x base_sample_shape</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Samples from the posterior, a tensor of shape
<cite>self._extended_shape(sample_shape=sample_shape)</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="botorch.posteriors.transformed.TransformedPosterior.rsample">
<span class="sig-name descname"><span class="pre">rsample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/botorch/posteriors/transformed.html#TransformedPosterior.rsample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#botorch.posteriors.transformed.TransformedPosterior.rsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample from the posterior (with gradients).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sample_shape</strong> (<em>Optional</em><em>[</em><em>Size</em><em>]</em>) – A <cite>torch.Size</cite> object specifying the sample shape. To
draw <cite>n</cite> samples, set to <cite>torch.Size([n])</cite>. To draw <cite>b</cite> batches
of <cite>n</cite> samples each, set to <cite>torch.Size([b, n])</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Samples from the posterior, a tensor of shape
<cite>self._extended_shape(sample_shape=sample_shape)</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>
</dd></dl>
</section>
<section id="module-botorch.posteriors.fully_bayesian">
<span id="fully-bayesian-posterior"></span><h3>Fully Bayesian Posterior<a class="headerlink" href="#module-botorch.posteriors.fully_bayesian" title="Permalink to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="botorch.posteriors.fully_bayesian.batched_bisect">
<span class="sig-prename descclassname"><span class="pre">botorch.posteriors.fully_bayesian.</span></span><span class="sig-name descname"><span class="pre">batched_bisect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/botorch/posteriors/fully_bayesian.html#batched_bisect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#botorch.posteriors.fully_bayesian.batched_bisect" title="Permalink to this definition">¶</a></dt>
<dd><p>Batched bisection with a fixed number of steps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>Callable</em>) – Target function that takes a <cite>(b1 x … x bk)</cite>-dim tensor and returns a
<cite>(b1 x … x bk)</cite>-dim tensor.</p></li>
<li><p><strong>target</strong> (<em>float</em>) – Scalar target value of type float.</p></li>
<li><p><strong>bounds</strong> (<em>Tensor</em>) – Lower and upper bounds, of size <cite>2 x b1 x … x bk</cite>.</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – We termniate if all elements satisfy are within <cite>tol</cite> of the <cite>target</cite>.</p></li>
<li><p><strong>max_steps</strong> (<em>int</em>) – Maximum number of bisection steps.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor X of size <cite>b1 x … x bk</cite> such that <cite>f(X) = target</cite>.</p>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="botorch.posteriors.fully_bayesian.FullyBayesianPosterior">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">botorch.posteriors.fully_bayesian.</span></span><span class="sig-name descname"><span class="pre">FullyBayesianPosterior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distribution</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/botorch/posteriors/fully_bayesian.html#FullyBayesianPosterior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#botorch.posteriors.fully_bayesian.FullyBayesianPosterior" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#botorch.posteriors.gpytorch.GPyTorchPosterior" title="botorch.posteriors.gpytorch.GPyTorchPosterior"><code class="xref py py-class docutils literal notranslate"><span class="pre">GPyTorchPosterior</span></code></a></p>
<p>A posterior for a fully Bayesian model.</p>
<p>The MCMC batch dimension that corresponds to the models in the mixture is located
at <cite>MCMC_DIM</cite> (defined at the top of this file). Note that while each MCMC sample
corresponds to a Gaussian posterior, the fully Bayesian posterior is rather a
mixture of Gaussian distributions.</p>
<p>A posterior for a fully Bayesian model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>distribution</strong> (<em>MultivariateNormal</em>) – A GPyTorch MultivariateNormal (single-output case)</p>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="botorch.posteriors.fully_bayesian.FullyBayesianPosterior.mixture_mean">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mixture_mean</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#botorch.posteriors.fully_bayesian.FullyBayesianPosterior.mixture_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>The posterior mean for the mixture of models.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="botorch.posteriors.fully_bayesian.FullyBayesianPosterior.mixture_variance">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mixture_variance</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#botorch.posteriors.fully_bayesian.FullyBayesianPosterior.mixture_variance" title="Permalink to this definition">¶</a></dt>
<dd><p>The posterior variance for the mixture of models.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="botorch.posteriors.fully_bayesian.FullyBayesianPosterior.quantile">
<span class="sig-name descname"><span class="pre">quantile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/botorch/posteriors/fully_bayesian.html#FullyBayesianPosterior.quantile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#botorch.posteriors.fully_bayesian.FullyBayesianPosterior.quantile" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the posterior quantiles for the mixture of models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>Tensor</em>) – </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="botorch.posteriors.fully_bayesian.FullyBayesianPosterior.batch_range">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">batch_range</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#botorch.posteriors.fully_bayesian.FullyBayesianPosterior.batch_range" title="Permalink to this definition">¶</a></dt>
<dd><p>The t-batch range.</p>
<p>This is used in samplers to identify the t-batch component of the
<cite>base_sample_shape</cite>. The base samples are expanded over the t-batches to
provide consistency in the acquisition values, i.e., to ensure that a
candidate produces same value regardless of its position on the t-batch.</p>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="botorch.posteriors.fully_bayesian.FullyBayesianPosterior.distribution">
<span class="sig-name descname"><span class="pre">distribution</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">MultivariateNormal</span></em><a class="headerlink" href="#botorch.posteriors.fully_bayesian.FullyBayesianPosterior.distribution" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
</dd></dl>
</section>
</section>
<section id="utilities">
<h2>Utilities<a class="headerlink" href="#utilities" title="Permalink to this heading">¶</a></h2>
<section id="module-botorch.posteriors.base_samples">
<span id="base-samples"></span><h3>Base Samples<a class="headerlink" href="#module-botorch.posteriors.base_samples" title="Permalink to this heading">¶</a></h3>
</section>
</section>
</section>
</div>
</div>
</div>
<div aria-label="main navigation" class="sphinxsidebar" role="navigation">
<div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">BoTorch</a></h1>
<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="acquisition.html">botorch.acquisition</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">botorch.models</a></li>
<li class="toctree-l1"><a class="reference internal" href="generation.html">botorch.generation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">botorch.posteriors</a></li>
<li class="toctree-l1"><a class="reference internal" href="optim.html">botorch.optim</a></li>
<li class="toctree-l1"><a class="reference internal" href="fit.html">botorch.fit</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling.html">botorch.sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="cross_validation.html">botorch.cross_validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="settings.html">botorch.settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">botorch.logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="test_functions.html">botorch.test_functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="exceptions.html">botorch.exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">botorch.utils</a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
<li><a href="index.html">Documentation overview</a><ul>
<li>Previous: <a href="generation.html" title="previous chapter">botorch.generation</a></li>
<li>Next: <a href="optim.html" title="next chapter">botorch.optim</a></li>
</ul></li>
</ul>
</div>
<div id="searchbox" role="search" style="display: none">
<h3 id="searchlabel">Quick search</h3>
<div class="searchformwrapper">
<form action="search.html" class="search" method="get">
<input aria-labelledby="searchlabel" autocapitalize="off" autocomplete="off" autocorrect="off" name="q" spellcheck="false" type="text"/>
<input type="submit" value="Go"/>
</form>
</div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
</div>
</div>
<div class="clearer"></div>
</div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/v/0.8.1/" class="nav-home"><img src="/v/0.8.1/img/botorch.png" alt="BoTorch" width="66" height="58"/></a><div class="footerSection"><h5>Docs</h5><a href="/v/0.8.1/docs/introduction">Introduction</a><a href="/v/0.8.1/docs/getting_started">Getting Started</a><a href="/v/0.8.1/tutorials/">Tutorials</a><a href="/v/0.8.1/api/">API Reference</a><a href="https://arxiv.org/abs/1910.06403">Paper</a></div><div class="footerSection"><h5>Legal</h5><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noreferrer noopener">Privacy</a><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noreferrer noopener">Terms</a></div><div class="footerSection"><h5>Social</h5><div class="social"><a class="github-button" href="https://github.com/pytorch/botorch" data-count-href="https://github.com/pytorch/botorch/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star BoTorch on GitHub">botorch</a></div></div></section><a href="https://opensource.facebook.com/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/v/0.8.1/img/oss_logo.png" alt="Meta Open Source" width="300" height="25"/></a><section class="copyright"> Copyright © 2023 Meta Platforms, Inc</section><script>
            (function() {
              var BAD_BASE = '/botorch/';
              if (window.location.origin !== 'https://botorch.org') {
                var pathname = window.location.pathname;
                var newPathname = pathname.slice(pathname.indexOf(BAD_BASE) === 0 ? BAD_BASE.length : 1);
                var newLocation = 'https://botorch.org/v/0.8.1/' + newPathname;
                console.log('redirecting to ' + newLocation);
                window.location.href = newLocation;
              }
            })();
          </script></footer></div></body></html>